{
  "version": "tree-0.1",
  "tree": {
    "id": "App",
    "path": "",
    "children": {
      "SecurityFindingGeneratorStack": {
        "id": "SecurityFindingGeneratorStack",
        "path": "SecurityFindingGeneratorStack",
        "children": {
          "latest_ec2_ami_id": {
            "id": "latest_ec2_ami_id",
            "path": "SecurityFindingGeneratorStack/latest_ec2_ami_id",
            "constructInfo": {
              "fqn": "aws-cdk-lib.CfnParameter",
              "version": "2.118.0"
            }
          },
          "cw_flow_logs_parameter": {
            "id": "cw_flow_logs_parameter",
            "path": "SecurityFindingGeneratorStack/cw_flow_logs_parameter",
            "constructInfo": {
              "fqn": "aws-cdk-lib.CfnParameter",
              "version": "2.118.0"
            }
          },
          "cw_flow_logs": {
            "id": "cw_flow_logs",
            "path": "SecurityFindingGeneratorStack/cw_flow_logs",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/cw_flow_logs/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::Logs::LogGroup",
                  "aws:cdk:cloudformation:props": {
                    "logGroupName": {
                      "Ref": "cwflowlogsparameter"
                    },
                    "retentionInDays": 365,
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_logs.CfnLogGroup",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_logs.LogGroup",
              "version": "2.118.0"
            }
          },
          "security_service_user_data": {
            "id": "security_service_user_data",
            "path": "SecurityFindingGeneratorStack/security_service_user_data",
            "constructInfo": {
              "fqn": "aws-cdk-lib.CfnParameter",
              "version": "2.118.0"
            }
          },
          "security_demo_parameter": {
            "id": "security_demo_parameter",
            "path": "SecurityFindingGeneratorStack/security_demo_parameter",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/security_demo_parameter/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::SSM::Parameter",
                  "aws:cdk:cloudformation:props": {
                    "allowedPattern": ".*",
                    "description": "This will determine the EC2 user data script to generate real findings. Allowed values are: inspector or guardduty.",
                    "name": "/security-demo-user-data",
                    "tags": {
                      "security-demo": "true"
                    },
                    "tier": "Standard",
                    "type": "String",
                    "value": {
                      "Ref": "securityserviceuserdata"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ssm.CfnParameter",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_ssm.StringParameter",
              "version": "2.118.0"
            }
          },
          "security_demo_vpc": {
            "id": "security_demo_vpc",
            "path": "SecurityFindingGeneratorStack/security_demo_vpc",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/security_demo_vpc/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::EC2::VPC",
                  "aws:cdk:cloudformation:props": {
                    "cidrBlock": "172.0.0.0/16",
                    "enableDnsHostnames": true,
                    "enableDnsSupport": true,
                    "instanceTenancy": "default",
                    "tags": [
                      {
                        "key": "Name",
                        "value": "SecurityFindingGeneratorStack/security_demo_vpc"
                      },
                      {
                        "key": "security_service",
                        "value": {
                          "Ref": "securityserviceuserdata"
                        }
                      },
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.CfnVPC",
                  "version": "2.118.0"
                }
              },
              "demo_public_subnetSubnet1": {
                "id": "demo_public_subnetSubnet1",
                "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet1",
                "children": {
                  "Subnet": {
                    "id": "Subnet",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet1/Subnet",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::Subnet",
                      "aws:cdk:cloudformation:props": {
                        "availabilityZone": {
                          "Fn::Select": [
                            0,
                            {
                              "Fn::GetAZs": ""
                            }
                          ]
                        },
                        "cidrBlock": "172.0.0.0/24",
                        "mapPublicIpOnLaunch": true,
                        "tags": [
                          {
                            "key": "aws-cdk:subnet-name",
                            "value": "demo_public_subnet"
                          },
                          {
                            "key": "aws-cdk:subnet-type",
                            "value": "Public"
                          },
                          {
                            "key": "Name",
                            "value": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet1"
                          },
                          {
                            "key": "security_service",
                            "value": {
                              "Ref": "securityserviceuserdata"
                            }
                          },
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ],
                        "vpcId": {
                          "Ref": "securitydemovpc19F98734"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnSubnet",
                      "version": "2.118.0"
                    }
                  },
                  "Acl": {
                    "id": "Acl",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet1/Acl",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.Resource",
                      "version": "2.118.0"
                    }
                  },
                  "RouteTable": {
                    "id": "RouteTable",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet1/RouteTable",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::RouteTable",
                      "aws:cdk:cloudformation:props": {
                        "tags": [
                          {
                            "key": "Name",
                            "value": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet1"
                          },
                          {
                            "key": "security_service",
                            "value": {
                              "Ref": "securityserviceuserdata"
                            }
                          },
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ],
                        "vpcId": {
                          "Ref": "securitydemovpc19F98734"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnRouteTable",
                      "version": "2.118.0"
                    }
                  },
                  "RouteTableAssociation": {
                    "id": "RouteTableAssociation",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet1/RouteTableAssociation",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::SubnetRouteTableAssociation",
                      "aws:cdk:cloudformation:props": {
                        "routeTableId": {
                          "Ref": "securitydemovpcdemopublicsubnetSubnet1RouteTable425FA69A"
                        },
                        "subnetId": {
                          "Ref": "securitydemovpcdemopublicsubnetSubnet1Subnet20F86AF9"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation",
                      "version": "2.118.0"
                    }
                  },
                  "DefaultRoute": {
                    "id": "DefaultRoute",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet1/DefaultRoute",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::Route",
                      "aws:cdk:cloudformation:props": {
                        "destinationCidrBlock": "0.0.0.0/0",
                        "gatewayId": {
                          "Ref": "securitydemovpcIGW650426DD"
                        },
                        "routeTableId": {
                          "Ref": "securitydemovpcdemopublicsubnetSubnet1RouteTable425FA69A"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnRoute",
                      "version": "2.118.0"
                    }
                  },
                  "EIP": {
                    "id": "EIP",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet1/EIP",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::EIP",
                      "aws:cdk:cloudformation:props": {
                        "domain": "vpc",
                        "tags": [
                          {
                            "key": "Name",
                            "value": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet1"
                          },
                          {
                            "key": "security_service",
                            "value": {
                              "Ref": "securityserviceuserdata"
                            }
                          },
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ]
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnEIP",
                      "version": "2.118.0"
                    }
                  },
                  "NATGateway": {
                    "id": "NATGateway",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet1/NATGateway",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::NatGateway",
                      "aws:cdk:cloudformation:props": {
                        "allocationId": {
                          "Fn::GetAtt": [
                            "securitydemovpcdemopublicsubnetSubnet1EIP409A760F",
                            "AllocationId"
                          ]
                        },
                        "subnetId": {
                          "Ref": "securitydemovpcdemopublicsubnetSubnet1Subnet20F86AF9"
                        },
                        "tags": [
                          {
                            "key": "Name",
                            "value": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet1"
                          },
                          {
                            "key": "security_service",
                            "value": {
                              "Ref": "securityserviceuserdata"
                            }
                          },
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ]
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnNatGateway",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.PublicSubnet",
                  "version": "2.118.0"
                }
              },
              "demo_public_subnetSubnet2": {
                "id": "demo_public_subnetSubnet2",
                "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet2",
                "children": {
                  "Subnet": {
                    "id": "Subnet",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet2/Subnet",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::Subnet",
                      "aws:cdk:cloudformation:props": {
                        "availabilityZone": {
                          "Fn::Select": [
                            1,
                            {
                              "Fn::GetAZs": ""
                            }
                          ]
                        },
                        "cidrBlock": "172.0.1.0/24",
                        "mapPublicIpOnLaunch": true,
                        "tags": [
                          {
                            "key": "aws-cdk:subnet-name",
                            "value": "demo_public_subnet"
                          },
                          {
                            "key": "aws-cdk:subnet-type",
                            "value": "Public"
                          },
                          {
                            "key": "Name",
                            "value": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet2"
                          },
                          {
                            "key": "security_service",
                            "value": {
                              "Ref": "securityserviceuserdata"
                            }
                          },
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ],
                        "vpcId": {
                          "Ref": "securitydemovpc19F98734"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnSubnet",
                      "version": "2.118.0"
                    }
                  },
                  "Acl": {
                    "id": "Acl",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet2/Acl",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.Resource",
                      "version": "2.118.0"
                    }
                  },
                  "RouteTable": {
                    "id": "RouteTable",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet2/RouteTable",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::RouteTable",
                      "aws:cdk:cloudformation:props": {
                        "tags": [
                          {
                            "key": "Name",
                            "value": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet2"
                          },
                          {
                            "key": "security_service",
                            "value": {
                              "Ref": "securityserviceuserdata"
                            }
                          },
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ],
                        "vpcId": {
                          "Ref": "securitydemovpc19F98734"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnRouteTable",
                      "version": "2.118.0"
                    }
                  },
                  "RouteTableAssociation": {
                    "id": "RouteTableAssociation",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet2/RouteTableAssociation",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::SubnetRouteTableAssociation",
                      "aws:cdk:cloudformation:props": {
                        "routeTableId": {
                          "Ref": "securitydemovpcdemopublicsubnetSubnet2RouteTable0BF013E9"
                        },
                        "subnetId": {
                          "Ref": "securitydemovpcdemopublicsubnetSubnet2Subnet92C97794"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation",
                      "version": "2.118.0"
                    }
                  },
                  "DefaultRoute": {
                    "id": "DefaultRoute",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_public_subnetSubnet2/DefaultRoute",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::Route",
                      "aws:cdk:cloudformation:props": {
                        "destinationCidrBlock": "0.0.0.0/0",
                        "gatewayId": {
                          "Ref": "securitydemovpcIGW650426DD"
                        },
                        "routeTableId": {
                          "Ref": "securitydemovpcdemopublicsubnetSubnet2RouteTable0BF013E9"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnRoute",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.PublicSubnet",
                  "version": "2.118.0"
                }
              },
              "demo_private_iso_subnetSubnet1": {
                "id": "demo_private_iso_subnetSubnet1",
                "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_iso_subnetSubnet1",
                "children": {
                  "Subnet": {
                    "id": "Subnet",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_iso_subnetSubnet1/Subnet",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::Subnet",
                      "aws:cdk:cloudformation:props": {
                        "availabilityZone": {
                          "Fn::Select": [
                            0,
                            {
                              "Fn::GetAZs": ""
                            }
                          ]
                        },
                        "cidrBlock": "172.0.2.0/24",
                        "mapPublicIpOnLaunch": false,
                        "tags": [
                          {
                            "key": "aws-cdk:subnet-name",
                            "value": "demo_private_iso_subnet"
                          },
                          {
                            "key": "aws-cdk:subnet-type",
                            "value": "Isolated"
                          },
                          {
                            "key": "Name",
                            "value": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_iso_subnetSubnet1"
                          },
                          {
                            "key": "security_service",
                            "value": {
                              "Ref": "securityserviceuserdata"
                            }
                          },
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ],
                        "vpcId": {
                          "Ref": "securitydemovpc19F98734"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnSubnet",
                      "version": "2.118.0"
                    }
                  },
                  "Acl": {
                    "id": "Acl",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_iso_subnetSubnet1/Acl",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.Resource",
                      "version": "2.118.0"
                    }
                  },
                  "RouteTable": {
                    "id": "RouteTable",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_iso_subnetSubnet1/RouteTable",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::RouteTable",
                      "aws:cdk:cloudformation:props": {
                        "tags": [
                          {
                            "key": "Name",
                            "value": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_iso_subnetSubnet1"
                          },
                          {
                            "key": "security_service",
                            "value": {
                              "Ref": "securityserviceuserdata"
                            }
                          },
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ],
                        "vpcId": {
                          "Ref": "securitydemovpc19F98734"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnRouteTable",
                      "version": "2.118.0"
                    }
                  },
                  "RouteTableAssociation": {
                    "id": "RouteTableAssociation",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_iso_subnetSubnet1/RouteTableAssociation",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::SubnetRouteTableAssociation",
                      "aws:cdk:cloudformation:props": {
                        "routeTableId": {
                          "Ref": "securitydemovpcdemoprivateisosubnetSubnet1RouteTable98300A7F"
                        },
                        "subnetId": {
                          "Ref": "securitydemovpcdemoprivateisosubnetSubnet1SubnetA3E5A884"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.PrivateSubnet",
                  "version": "2.118.0"
                }
              },
              "demo_private_iso_subnetSubnet2": {
                "id": "demo_private_iso_subnetSubnet2",
                "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_iso_subnetSubnet2",
                "children": {
                  "Subnet": {
                    "id": "Subnet",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_iso_subnetSubnet2/Subnet",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::Subnet",
                      "aws:cdk:cloudformation:props": {
                        "availabilityZone": {
                          "Fn::Select": [
                            1,
                            {
                              "Fn::GetAZs": ""
                            }
                          ]
                        },
                        "cidrBlock": "172.0.3.0/24",
                        "mapPublicIpOnLaunch": false,
                        "tags": [
                          {
                            "key": "aws-cdk:subnet-name",
                            "value": "demo_private_iso_subnet"
                          },
                          {
                            "key": "aws-cdk:subnet-type",
                            "value": "Isolated"
                          },
                          {
                            "key": "Name",
                            "value": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_iso_subnetSubnet2"
                          },
                          {
                            "key": "security_service",
                            "value": {
                              "Ref": "securityserviceuserdata"
                            }
                          },
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ],
                        "vpcId": {
                          "Ref": "securitydemovpc19F98734"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnSubnet",
                      "version": "2.118.0"
                    }
                  },
                  "Acl": {
                    "id": "Acl",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_iso_subnetSubnet2/Acl",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.Resource",
                      "version": "2.118.0"
                    }
                  },
                  "RouteTable": {
                    "id": "RouteTable",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_iso_subnetSubnet2/RouteTable",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::RouteTable",
                      "aws:cdk:cloudformation:props": {
                        "tags": [
                          {
                            "key": "Name",
                            "value": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_iso_subnetSubnet2"
                          },
                          {
                            "key": "security_service",
                            "value": {
                              "Ref": "securityserviceuserdata"
                            }
                          },
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ],
                        "vpcId": {
                          "Ref": "securitydemovpc19F98734"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnRouteTable",
                      "version": "2.118.0"
                    }
                  },
                  "RouteTableAssociation": {
                    "id": "RouteTableAssociation",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_iso_subnetSubnet2/RouteTableAssociation",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::SubnetRouteTableAssociation",
                      "aws:cdk:cloudformation:props": {
                        "routeTableId": {
                          "Ref": "securitydemovpcdemoprivateisosubnetSubnet2RouteTable9E8343A9"
                        },
                        "subnetId": {
                          "Ref": "securitydemovpcdemoprivateisosubnetSubnet2Subnet5AC8A6B6"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.PrivateSubnet",
                  "version": "2.118.0"
                }
              },
              "demo_private_nat_subnetSubnet1": {
                "id": "demo_private_nat_subnetSubnet1",
                "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_nat_subnetSubnet1",
                "children": {
                  "Subnet": {
                    "id": "Subnet",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_nat_subnetSubnet1/Subnet",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::Subnet",
                      "aws:cdk:cloudformation:props": {
                        "availabilityZone": {
                          "Fn::Select": [
                            0,
                            {
                              "Fn::GetAZs": ""
                            }
                          ]
                        },
                        "cidrBlock": "172.0.4.0/24",
                        "mapPublicIpOnLaunch": false,
                        "tags": [
                          {
                            "key": "aws-cdk:subnet-name",
                            "value": "demo_private_nat_subnet"
                          },
                          {
                            "key": "aws-cdk:subnet-type",
                            "value": "Private"
                          },
                          {
                            "key": "Name",
                            "value": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_nat_subnetSubnet1"
                          },
                          {
                            "key": "security_service",
                            "value": {
                              "Ref": "securityserviceuserdata"
                            }
                          },
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ],
                        "vpcId": {
                          "Ref": "securitydemovpc19F98734"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnSubnet",
                      "version": "2.118.0"
                    }
                  },
                  "Acl": {
                    "id": "Acl",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_nat_subnetSubnet1/Acl",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.Resource",
                      "version": "2.118.0"
                    }
                  },
                  "RouteTable": {
                    "id": "RouteTable",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_nat_subnetSubnet1/RouteTable",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::RouteTable",
                      "aws:cdk:cloudformation:props": {
                        "tags": [
                          {
                            "key": "Name",
                            "value": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_nat_subnetSubnet1"
                          },
                          {
                            "key": "security_service",
                            "value": {
                              "Ref": "securityserviceuserdata"
                            }
                          },
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ],
                        "vpcId": {
                          "Ref": "securitydemovpc19F98734"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnRouteTable",
                      "version": "2.118.0"
                    }
                  },
                  "RouteTableAssociation": {
                    "id": "RouteTableAssociation",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_nat_subnetSubnet1/RouteTableAssociation",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::SubnetRouteTableAssociation",
                      "aws:cdk:cloudformation:props": {
                        "routeTableId": {
                          "Ref": "securitydemovpcdemoprivatenatsubnetSubnet1RouteTable24820C04"
                        },
                        "subnetId": {
                          "Ref": "securitydemovpcdemoprivatenatsubnetSubnet1SubnetF2EA78AC"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation",
                      "version": "2.118.0"
                    }
                  },
                  "DefaultRoute": {
                    "id": "DefaultRoute",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_nat_subnetSubnet1/DefaultRoute",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::Route",
                      "aws:cdk:cloudformation:props": {
                        "destinationCidrBlock": "0.0.0.0/0",
                        "natGatewayId": {
                          "Ref": "securitydemovpcdemopublicsubnetSubnet1NATGatewayDDB85835"
                        },
                        "routeTableId": {
                          "Ref": "securitydemovpcdemoprivatenatsubnetSubnet1RouteTable24820C04"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnRoute",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.PrivateSubnet",
                  "version": "2.118.0"
                }
              },
              "demo_private_nat_subnetSubnet2": {
                "id": "demo_private_nat_subnetSubnet2",
                "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_nat_subnetSubnet2",
                "children": {
                  "Subnet": {
                    "id": "Subnet",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_nat_subnetSubnet2/Subnet",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::Subnet",
                      "aws:cdk:cloudformation:props": {
                        "availabilityZone": {
                          "Fn::Select": [
                            1,
                            {
                              "Fn::GetAZs": ""
                            }
                          ]
                        },
                        "cidrBlock": "172.0.5.0/24",
                        "mapPublicIpOnLaunch": false,
                        "tags": [
                          {
                            "key": "aws-cdk:subnet-name",
                            "value": "demo_private_nat_subnet"
                          },
                          {
                            "key": "aws-cdk:subnet-type",
                            "value": "Private"
                          },
                          {
                            "key": "Name",
                            "value": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_nat_subnetSubnet2"
                          },
                          {
                            "key": "security_service",
                            "value": {
                              "Ref": "securityserviceuserdata"
                            }
                          },
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ],
                        "vpcId": {
                          "Ref": "securitydemovpc19F98734"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnSubnet",
                      "version": "2.118.0"
                    }
                  },
                  "Acl": {
                    "id": "Acl",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_nat_subnetSubnet2/Acl",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.Resource",
                      "version": "2.118.0"
                    }
                  },
                  "RouteTable": {
                    "id": "RouteTable",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_nat_subnetSubnet2/RouteTable",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::RouteTable",
                      "aws:cdk:cloudformation:props": {
                        "tags": [
                          {
                            "key": "Name",
                            "value": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_nat_subnetSubnet2"
                          },
                          {
                            "key": "security_service",
                            "value": {
                              "Ref": "securityserviceuserdata"
                            }
                          },
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ],
                        "vpcId": {
                          "Ref": "securitydemovpc19F98734"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnRouteTable",
                      "version": "2.118.0"
                    }
                  },
                  "RouteTableAssociation": {
                    "id": "RouteTableAssociation",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_nat_subnetSubnet2/RouteTableAssociation",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::SubnetRouteTableAssociation",
                      "aws:cdk:cloudformation:props": {
                        "routeTableId": {
                          "Ref": "securitydemovpcdemoprivatenatsubnetSubnet2RouteTableC76AF443"
                        },
                        "subnetId": {
                          "Ref": "securitydemovpcdemoprivatenatsubnetSubnet2Subnet05A280E1"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation",
                      "version": "2.118.0"
                    }
                  },
                  "DefaultRoute": {
                    "id": "DefaultRoute",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/demo_private_nat_subnetSubnet2/DefaultRoute",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::Route",
                      "aws:cdk:cloudformation:props": {
                        "destinationCidrBlock": "0.0.0.0/0",
                        "natGatewayId": {
                          "Ref": "securitydemovpcdemopublicsubnetSubnet1NATGatewayDDB85835"
                        },
                        "routeTableId": {
                          "Ref": "securitydemovpcdemoprivatenatsubnetSubnet2RouteTableC76AF443"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnRoute",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.PrivateSubnet",
                  "version": "2.118.0"
                }
              },
              "IGW": {
                "id": "IGW",
                "path": "SecurityFindingGeneratorStack/security_demo_vpc/IGW",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::EC2::InternetGateway",
                  "aws:cdk:cloudformation:props": {
                    "tags": [
                      {
                        "key": "Name",
                        "value": "SecurityFindingGeneratorStack/security_demo_vpc"
                      },
                      {
                        "key": "security_service",
                        "value": {
                          "Ref": "securityserviceuserdata"
                        }
                      },
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.CfnInternetGateway",
                  "version": "2.118.0"
                }
              },
              "VPCGW": {
                "id": "VPCGW",
                "path": "SecurityFindingGeneratorStack/security_demo_vpc/VPCGW",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::EC2::VPCGatewayAttachment",
                  "aws:cdk:cloudformation:props": {
                    "internetGatewayId": {
                      "Ref": "securitydemovpcIGW650426DD"
                    },
                    "vpcId": {
                      "Ref": "securitydemovpc19F98734"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.CfnVPCGatewayAttachment",
                  "version": "2.118.0"
                }
              },
              "s3": {
                "id": "s3",
                "path": "SecurityFindingGeneratorStack/security_demo_vpc/s3",
                "children": {
                  "IAMRole": {
                    "id": "IAMRole",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/s3/IAMRole",
                    "children": {
                      "ImportIAMRole": {
                        "id": "ImportIAMRole",
                        "path": "SecurityFindingGeneratorStack/security_demo_vpc/s3/IAMRole/ImportIAMRole",
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.Resource",
                          "version": "2.118.0"
                        }
                      },
                      "Resource": {
                        "id": "Resource",
                        "path": "SecurityFindingGeneratorStack/security_demo_vpc/s3/IAMRole/Resource",
                        "attributes": {
                          "aws:cdk:cloudformation:type": "AWS::IAM::Role",
                          "aws:cdk:cloudformation:props": {
                            "assumeRolePolicyDocument": {
                              "Statement": [
                                {
                                  "Action": "sts:AssumeRole",
                                  "Effect": "Allow",
                                  "Principal": {
                                    "Service": "vpc-flow-logs.amazonaws.com"
                                  }
                                }
                              ],
                              "Version": "2012-10-17"
                            },
                            "tags": [
                              {
                                "key": "Name",
                                "value": "SecurityFindingGeneratorStack/security_demo_vpc/s3"
                              },
                              {
                                "key": "security_service",
                                "value": {
                                  "Ref": "securityserviceuserdata"
                                }
                              },
                              {
                                "key": "security-demo",
                                "value": "true"
                              }
                            ]
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_iam.CfnRole",
                          "version": "2.118.0"
                        }
                      },
                      "DefaultPolicy": {
                        "id": "DefaultPolicy",
                        "path": "SecurityFindingGeneratorStack/security_demo_vpc/s3/IAMRole/DefaultPolicy",
                        "children": {
                          "Resource": {
                            "id": "Resource",
                            "path": "SecurityFindingGeneratorStack/security_demo_vpc/s3/IAMRole/DefaultPolicy/Resource",
                            "attributes": {
                              "aws:cdk:cloudformation:type": "AWS::IAM::Policy",
                              "aws:cdk:cloudformation:props": {
                                "policyDocument": {
                                  "Statement": [
                                    {
                                      "Action": [
                                        "logs:CreateLogStream",
                                        "logs:DescribeLogStreams",
                                        "logs:PutLogEvents"
                                      ],
                                      "Effect": "Allow",
                                      "Resource": {
                                        "Fn::GetAtt": [
                                          "cwflowlogs3E4CC8F1",
                                          "Arn"
                                        ]
                                      }
                                    },
                                    {
                                      "Action": "iam:PassRole",
                                      "Effect": "Allow",
                                      "Resource": {
                                        "Fn::GetAtt": [
                                          "securitydemovpcs3IAMRole5C71C7E6",
                                          "Arn"
                                        ]
                                      }
                                    }
                                  ],
                                  "Version": "2012-10-17"
                                },
                                "policyName": "securitydemovpcs3IAMRoleDefaultPolicy1F2CD207",
                                "roles": [
                                  {
                                    "Ref": "securitydemovpcs3IAMRole5C71C7E6"
                                  }
                                ]
                              }
                            },
                            "constructInfo": {
                              "fqn": "aws-cdk-lib.aws_iam.CfnPolicy",
                              "version": "2.118.0"
                            }
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_iam.Policy",
                          "version": "2.118.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_iam.Role",
                      "version": "2.118.0"
                    }
                  },
                  "FlowLog": {
                    "id": "FlowLog",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/s3/FlowLog",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::FlowLog",
                      "aws:cdk:cloudformation:props": {
                        "deliverLogsPermissionArn": {
                          "Fn::GetAtt": [
                            "securitydemovpcs3IAMRole5C71C7E6",
                            "Arn"
                          ]
                        },
                        "logDestinationType": "cloud-watch-logs",
                        "logGroupName": {
                          "Ref": "cwflowlogs3E4CC8F1"
                        },
                        "resourceId": {
                          "Ref": "securitydemovpc19F98734"
                        },
                        "resourceType": "VPC",
                        "tags": [
                          {
                            "key": "Name",
                            "value": "SecurityFindingGeneratorStack/security_demo_vpc/s3"
                          },
                          {
                            "key": "security_service",
                            "value": {
                              "Ref": "securityserviceuserdata"
                            }
                          },
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ],
                        "trafficType": "ALL"
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnFlowLog",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.FlowLog",
                  "version": "2.118.0"
                }
              },
              "ec2_endpoint": {
                "id": "ec2_endpoint",
                "path": "SecurityFindingGeneratorStack/security_demo_vpc/ec2_endpoint",
                "children": {
                  "Resource": {
                    "id": "Resource",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/ec2_endpoint/Resource",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::VPCEndpoint",
                      "aws:cdk:cloudformation:props": {
                        "privateDnsEnabled": true,
                        "securityGroupIds": [
                          {
                            "Fn::GetAtt": [
                              "securitydemosg72A385FB",
                              "GroupId"
                            ]
                          }
                        ],
                        "serviceName": {
                          "Fn::Join": [
                            "",
                            [
                              "com.amazonaws.",
                              {
                                "Ref": "AWS::Region"
                              },
                              ".ec2"
                            ]
                          ]
                        },
                        "subnetIds": [
                          {
                            "Ref": "securitydemovpcdemoprivatenatsubnetSubnet1SubnetF2EA78AC"
                          }
                        ],
                        "vpcEndpointType": "Interface",
                        "vpcId": {
                          "Ref": "securitydemovpc19F98734"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnVPCEndpoint",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.InterfaceVpcEndpoint",
                  "version": "2.118.0"
                }
              },
              "ec2_msg_endpoint": {
                "id": "ec2_msg_endpoint",
                "path": "SecurityFindingGeneratorStack/security_demo_vpc/ec2_msg_endpoint",
                "children": {
                  "Resource": {
                    "id": "Resource",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/ec2_msg_endpoint/Resource",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::VPCEndpoint",
                      "aws:cdk:cloudformation:props": {
                        "privateDnsEnabled": true,
                        "securityGroupIds": [
                          {
                            "Fn::GetAtt": [
                              "securitydemosg72A385FB",
                              "GroupId"
                            ]
                          }
                        ],
                        "serviceName": {
                          "Fn::Join": [
                            "",
                            [
                              "com.amazonaws.",
                              {
                                "Ref": "AWS::Region"
                              },
                              ".ec2messages"
                            ]
                          ]
                        },
                        "subnetIds": [
                          {
                            "Ref": "securitydemovpcdemoprivatenatsubnetSubnet1SubnetF2EA78AC"
                          }
                        ],
                        "vpcEndpointType": "Interface",
                        "vpcId": {
                          "Ref": "securitydemovpc19F98734"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnVPCEndpoint",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.InterfaceVpcEndpoint",
                  "version": "2.118.0"
                }
              },
              "kms_endpoint": {
                "id": "kms_endpoint",
                "path": "SecurityFindingGeneratorStack/security_demo_vpc/kms_endpoint",
                "children": {
                  "Resource": {
                    "id": "Resource",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/kms_endpoint/Resource",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::VPCEndpoint",
                      "aws:cdk:cloudformation:props": {
                        "privateDnsEnabled": true,
                        "securityGroupIds": [
                          {
                            "Fn::GetAtt": [
                              "securitydemosg72A385FB",
                              "GroupId"
                            ]
                          }
                        ],
                        "serviceName": {
                          "Fn::Join": [
                            "",
                            [
                              "com.amazonaws.",
                              {
                                "Ref": "AWS::Region"
                              },
                              ".kms"
                            ]
                          ]
                        },
                        "subnetIds": [
                          {
                            "Ref": "securitydemovpcdemoprivatenatsubnetSubnet1SubnetF2EA78AC"
                          }
                        ],
                        "vpcEndpointType": "Interface",
                        "vpcId": {
                          "Ref": "securitydemovpc19F98734"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnVPCEndpoint",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.InterfaceVpcEndpoint",
                  "version": "2.118.0"
                }
              },
              "ssm_endpoint": {
                "id": "ssm_endpoint",
                "path": "SecurityFindingGeneratorStack/security_demo_vpc/ssm_endpoint",
                "children": {
                  "Resource": {
                    "id": "Resource",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/ssm_endpoint/Resource",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::VPCEndpoint",
                      "aws:cdk:cloudformation:props": {
                        "privateDnsEnabled": true,
                        "securityGroupIds": [
                          {
                            "Fn::GetAtt": [
                              "securitydemosg72A385FB",
                              "GroupId"
                            ]
                          }
                        ],
                        "serviceName": {
                          "Fn::Join": [
                            "",
                            [
                              "com.amazonaws.",
                              {
                                "Ref": "AWS::Region"
                              },
                              ".ssm"
                            ]
                          ]
                        },
                        "subnetIds": [
                          {
                            "Ref": "securitydemovpcdemoprivatenatsubnetSubnet1SubnetF2EA78AC"
                          }
                        ],
                        "vpcEndpointType": "Interface",
                        "vpcId": {
                          "Ref": "securitydemovpc19F98734"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnVPCEndpoint",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.InterfaceVpcEndpoint",
                  "version": "2.118.0"
                }
              },
              "ssm_msg_endpoint": {
                "id": "ssm_msg_endpoint",
                "path": "SecurityFindingGeneratorStack/security_demo_vpc/ssm_msg_endpoint",
                "children": {
                  "Resource": {
                    "id": "Resource",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/ssm_msg_endpoint/Resource",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::VPCEndpoint",
                      "aws:cdk:cloudformation:props": {
                        "privateDnsEnabled": true,
                        "securityGroupIds": [
                          {
                            "Fn::GetAtt": [
                              "securitydemosg72A385FB",
                              "GroupId"
                            ]
                          }
                        ],
                        "serviceName": {
                          "Fn::Join": [
                            "",
                            [
                              "com.amazonaws.",
                              {
                                "Ref": "AWS::Region"
                              },
                              ".ssmmessages"
                            ]
                          ]
                        },
                        "subnetIds": [
                          {
                            "Ref": "securitydemovpcdemoprivatenatsubnetSubnet1SubnetF2EA78AC"
                          }
                        ],
                        "vpcEndpointType": "Interface",
                        "vpcId": {
                          "Ref": "securitydemovpc19F98734"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnVPCEndpoint",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.InterfaceVpcEndpoint",
                  "version": "2.118.0"
                }
              },
              "s3_endpoint": {
                "id": "s3_endpoint",
                "path": "SecurityFindingGeneratorStack/security_demo_vpc/s3_endpoint",
                "children": {
                  "Resource": {
                    "id": "Resource",
                    "path": "SecurityFindingGeneratorStack/security_demo_vpc/s3_endpoint/Resource",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::EC2::VPCEndpoint",
                      "aws:cdk:cloudformation:props": {
                        "privateDnsEnabled": false,
                        "securityGroupIds": [
                          {
                            "Fn::GetAtt": [
                              "securitydemosg72A385FB",
                              "GroupId"
                            ]
                          }
                        ],
                        "serviceName": "com.amazonaws.ap-northeast-1.s3",
                        "subnetIds": [
                          {
                            "Ref": "securitydemovpcdemoprivatenatsubnetSubnet1SubnetF2EA78AC"
                          }
                        ],
                        "vpcEndpointType": "Interface",
                        "vpcId": {
                          "Ref": "securitydemovpc19F98734"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_ec2.CfnVPCEndpoint",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.InterfaceVpcEndpoint",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_ec2.Vpc",
              "version": "2.118.0"
            }
          },
          "security_demo_sg": {
            "id": "security_demo_sg",
            "path": "SecurityFindingGeneratorStack/security_demo_sg",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/security_demo_sg/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::EC2::SecurityGroup",
                  "aws:cdk:cloudformation:props": {
                    "groupDescription": "Security demo workload security group.",
                    "groupName": "security_demo_sg",
                    "securityGroupEgress": [
                      {
                        "cidrIp": "0.0.0.0/0",
                        "ipProtocol": "tcp",
                        "fromPort": 443,
                        "toPort": 443,
                        "description": "Allow HTTPS Outbound for Egress internet connectivity"
                      },
                      {
                        "cidrIp": "0.0.0.0/0",
                        "ipProtocol": "tcp",
                        "fromPort": 80,
                        "toPort": 80,
                        "description": "Allow HTTP Outbound for Egress internet connectivity"
                      },
                      {
                        "cidrIp": "0.0.0.0/0",
                        "ipProtocol": "tcp",
                        "fromPort": 17777,
                        "toPort": 17777,
                        "description": "Allow BitcoinTool (17777) Outbound for Egress internet connectivity"
                      },
                      {
                        "cidrIp": "0.0.0.0/0",
                        "ipProtocol": "tcp",
                        "fromPort": 587,
                        "toPort": 587,
                        "description": "Allow DropPoint (587) Outbound for Egress internet connectivity"
                      }
                    ],
                    "securityGroupIngress": [
                      {
                        "cidrIp": {
                          "Fn::GetAtt": [
                            "securitydemovpc19F98734",
                            "CidrBlock"
                          ]
                        },
                        "ipProtocol": "tcp",
                        "fromPort": 443,
                        "toPort": 443,
                        "description": {
                          "Fn::Join": [
                            "",
                            [
                              "from ",
                              {
                                "Fn::GetAtt": [
                                  "securitydemovpc19F98734",
                                  "CidrBlock"
                                ]
                              },
                              ":443"
                            ]
                          ]
                        }
                      }
                    ],
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ],
                    "vpcId": {
                      "Ref": "securitydemovpc19F98734"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.CfnSecurityGroup",
                  "version": "2.118.0"
                }
              },
              "to SecurityFindingGeneratorStacksecuritydemosgAFB78EF5:443": {
                "id": "to SecurityFindingGeneratorStacksecuritydemosgAFB78EF5:443",
                "path": "SecurityFindingGeneratorStack/security_demo_sg/to SecurityFindingGeneratorStacksecuritydemosgAFB78EF5:443",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::EC2::SecurityGroupEgress",
                  "aws:cdk:cloudformation:props": {
                    "description": "Allow HTTPS Outbound for PrivateLink",
                    "destinationSecurityGroupId": {
                      "Fn::GetAtt": [
                        "securitydemosg72A385FB",
                        "GroupId"
                      ]
                    },
                    "fromPort": 443,
                    "groupId": {
                      "Fn::GetAtt": [
                        "securitydemosg72A385FB",
                        "GroupId"
                      ]
                    },
                    "ipProtocol": "tcp",
                    "toPort": 443
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.CfnSecurityGroupEgress",
                  "version": "2.118.0"
                }
              },
              "from SecurityFindingGeneratorStacksecuritydemosgAFB78EF5:443": {
                "id": "from SecurityFindingGeneratorStacksecuritydemosgAFB78EF5:443",
                "path": "SecurityFindingGeneratorStack/security_demo_sg/from SecurityFindingGeneratorStacksecuritydemosgAFB78EF5:443",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::EC2::SecurityGroupIngress",
                  "aws:cdk:cloudformation:props": {
                    "description": "Allow HTTPS Inbound for PrivateLink",
                    "fromPort": 443,
                    "groupId": {
                      "Fn::GetAtt": [
                        "securitydemosg72A385FB",
                        "GroupId"
                      ]
                    },
                    "ipProtocol": "tcp",
                    "sourceSecurityGroupId": {
                      "Fn::GetAtt": [
                        "securitydemosg72A385FB",
                        "GroupId"
                      ]
                    },
                    "toPort": 443
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_ec2.SecurityGroup",
              "version": "2.118.0"
            }
          },
          "security_demo_s3_user_data_key": {
            "id": "security_demo_s3_user_data_key",
            "path": "SecurityFindingGeneratorStack/security_demo_s3_user_data_key",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/security_demo_s3_user_data_key/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::KMS::Key",
                  "aws:cdk:cloudformation:props": {
                    "description": "KMS key for S3 Bucket for EC2 user data scripts.",
                    "enableKeyRotation": true,
                    "keyPolicy": {
                      "Statement": [
                        {
                          "Action": "kms:*",
                          "Effect": "Allow",
                          "Principal": {
                            "AWS": {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":iam::",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":root"
                                ]
                              ]
                            }
                          },
                          "Resource": "*"
                        },
                        {
                          "Action": [
                            "kms:Decrypt",
                            "kms:Describe",
                            "kms:GenerateDataKey"
                          ],
                          "Effect": "Allow",
                          "Principal": {
                            "AWS": [
                              {
                                "Fn::GetAtt": [
                                  "ec2generalrole126EB842",
                                  "Arn"
                                ]
                              },
                              {
                                "Fn::GetAtt": [
                                  "ec2instancemodulerole43B94AC9",
                                  "Arn"
                                ]
                              },
                              {
                                "Fn::GetAtt": [
                                  "lambdathreatlistrole03396CF8",
                                  "Arn"
                                ]
                              },
                              {
                                "Fn::Join": [
                                  "",
                                  [
                                    "arn:aws:iam::",
                                    {
                                      "Ref": "AWS::AccountId"
                                    },
                                    ":role/aws-service-role/guardduty.amazonaws.com/AWSServiceRoleForAmazonGuardDuty"
                                  ]
                                ]
                              }
                            ]
                          },
                          "Resource": "*"
                        },
                        {
                          "Action": [
                            "kms:Decrypt",
                            "kms:Encrypt",
                            "kms:GenerateDataKey*",
                            "kms:ReEncrypt*"
                          ],
                          "Effect": "Allow",
                          "Principal": {
                            "Service": "logging.s3.amazonaws.com"
                          },
                          "Resource": "*"
                        },
                        {
                          "Action": [
                            "kms:CreateGrant",
                            "kms:Decrypt",
                            "kms:DescribeKey",
                            "kms:Encrypt",
                            "kms:GenerateDataKey*",
                            "kms:ReEncrypt*"
                          ],
                          "Condition": {
                            "StringEquals": {
                              "kms:ViaService": {
                                "Fn::Join": [
                                  "",
                                  [
                                    "secretsmanager.",
                                    {
                                      "Ref": "AWS::Region"
                                    },
                                    ".amazonaws.com"
                                  ]
                                ]
                              }
                            }
                          },
                          "Effect": "Allow",
                          "Principal": {
                            "AWS": {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":iam::",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":root"
                                ]
                              ]
                            }
                          },
                          "Resource": "*"
                        }
                      ],
                      "Version": "2012-10-17"
                    },
                    "pendingWindowInDays": 7,
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_kms.CfnKey",
                  "version": "2.118.0"
                }
              },
              "Alias": {
                "id": "Alias",
                "path": "SecurityFindingGeneratorStack/security_demo_s3_user_data_key/Alias",
                "children": {
                  "Resource": {
                    "id": "Resource",
                    "path": "SecurityFindingGeneratorStack/security_demo_s3_user_data_key/Alias/Resource",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::KMS::Alias",
                      "aws:cdk:cloudformation:props": {
                        "aliasName": "alias/security_demo_s3_key",
                        "targetKeyId": {
                          "Fn::GetAtt": [
                            "securitydemos3userdatakey646F9E0C",
                            "Arn"
                          ]
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_kms.CfnAlias",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_kms.Alias",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_kms.Key",
              "version": "2.118.0"
            }
          },
          "security_demo_s3_user_data_bucket": {
            "id": "security_demo_s3_user_data_bucket",
            "path": "SecurityFindingGeneratorStack/security_demo_s3_user_data_bucket",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/security_demo_s3_user_data_bucket/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::S3::Bucket",
                  "aws:cdk:cloudformation:props": {
                    "accessControl": "LogDeliveryWrite",
                    "bucketEncryption": {
                      "serverSideEncryptionConfiguration": [
                        {
                          "bucketKeyEnabled": true,
                          "serverSideEncryptionByDefault": {
                            "sseAlgorithm": "aws:kms",
                            "kmsMasterKeyId": {
                              "Fn::GetAtt": [
                                "securitydemos3userdatakey646F9E0C",
                                "Arn"
                              ]
                            }
                          }
                        }
                      ]
                    },
                    "bucketName": {
                      "Fn::Join": [
                        "",
                        [
                          "security-demo-user-data-bucket",
                          {
                            "Ref": "AWS::AccountId"
                          },
                          "-",
                          {
                            "Ref": "AWS::Region"
                          }
                        ]
                      ]
                    },
                    "ownershipControls": {
                      "rules": [
                        {
                          "objectOwnership": "BucketOwnerPreferred"
                        }
                      ]
                    },
                    "publicAccessBlockConfiguration": {
                      "blockPublicAcls": true,
                      "blockPublicPolicy": true,
                      "ignorePublicAcls": true,
                      "restrictPublicBuckets": true
                    },
                    "tags": [
                      {
                        "key": "aws-cdk:auto-delete-objects",
                        "value": "true"
                      },
                      {
                        "key": "aws-cdk:cr-owned:ec2-user-data-demo/:cc7bdfac",
                        "value": "true"
                      },
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ],
                    "versioningConfiguration": {
                      "status": "Enabled"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_s3.CfnBucket",
                  "version": "2.118.0"
                }
              },
              "Policy": {
                "id": "Policy",
                "path": "SecurityFindingGeneratorStack/security_demo_s3_user_data_bucket/Policy",
                "children": {
                  "Resource": {
                    "id": "Resource",
                    "path": "SecurityFindingGeneratorStack/security_demo_s3_user_data_bucket/Policy/Resource",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::S3::BucketPolicy",
                      "aws:cdk:cloudformation:props": {
                        "bucket": {
                          "Ref": "securitydemos3userdatabucketC56A23F8"
                        },
                        "policyDocument": {
                          "Statement": [
                            {
                              "Action": "s3:*",
                              "Condition": {
                                "Bool": {
                                  "aws:SecureTransport": "false"
                                }
                              },
                              "Effect": "Deny",
                              "Principal": {
                                "AWS": "*"
                              },
                              "Resource": [
                                {
                                  "Fn::GetAtt": [
                                    "securitydemos3userdatabucketC56A23F8",
                                    "Arn"
                                  ]
                                },
                                {
                                  "Fn::Join": [
                                    "",
                                    [
                                      {
                                        "Fn::GetAtt": [
                                          "securitydemos3userdatabucketC56A23F8",
                                          "Arn"
                                        ]
                                      },
                                      "/*"
                                    ]
                                  ]
                                }
                              ]
                            },
                            {
                              "Action": [
                                "s3:DeleteObject*",
                                "s3:GetBucket*",
                                "s3:List*",
                                "s3:PutBucketPolicy"
                              ],
                              "Effect": "Allow",
                              "Principal": {
                                "AWS": {
                                  "Fn::GetAtt": [
                                    "CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092",
                                    "Arn"
                                  ]
                                }
                              },
                              "Resource": [
                                {
                                  "Fn::GetAtt": [
                                    "securitydemos3userdatabucketC56A23F8",
                                    "Arn"
                                  ]
                                },
                                {
                                  "Fn::Join": [
                                    "",
                                    [
                                      {
                                        "Fn::GetAtt": [
                                          "securitydemos3userdatabucketC56A23F8",
                                          "Arn"
                                        ]
                                      },
                                      "/*"
                                    ]
                                  ]
                                }
                              ]
                            },
                            {
                              "Action": [
                                "s3:GetObject",
                                "s3:ListBucket",
                                "s3:PutObject"
                              ],
                              "Effect": "Allow",
                              "Principal": {
                                "AWS": [
                                  {
                                    "Fn::GetAtt": [
                                      "ec2generalrole126EB842",
                                      "Arn"
                                    ]
                                  },
                                  {
                                    "Fn::GetAtt": [
                                      "ec2instancemodulerole43B94AC9",
                                      "Arn"
                                    ]
                                  },
                                  {
                                    "Fn::GetAtt": [
                                      "lambdathreatlistrole03396CF8",
                                      "Arn"
                                    ]
                                  }
                                ]
                              },
                              "Resource": [
                                {
                                  "Fn::GetAtt": [
                                    "securitydemos3userdatabucketC56A23F8",
                                    "Arn"
                                  ]
                                },
                                {
                                  "Fn::Join": [
                                    "",
                                    [
                                      {
                                        "Fn::GetAtt": [
                                          "securitydemos3userdatabucketC56A23F8",
                                          "Arn"
                                        ]
                                      },
                                      "/*"
                                    ]
                                  ]
                                }
                              ]
                            }
                          ],
                          "Version": "2012-10-17"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_s3.CfnBucketPolicy",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_s3.BucketPolicy",
                  "version": "2.118.0"
                }
              },
              "AutoDeleteObjectsCustomResource": {
                "id": "AutoDeleteObjectsCustomResource",
                "path": "SecurityFindingGeneratorStack/security_demo_s3_user_data_bucket/AutoDeleteObjectsCustomResource",
                "children": {
                  "Default": {
                    "id": "Default",
                    "path": "SecurityFindingGeneratorStack/security_demo_s3_user_data_bucket/AutoDeleteObjectsCustomResource/Default",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.CfnResource",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.CustomResource",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_s3.Bucket",
              "version": "2.118.0"
            }
          },
          "Custom::S3AutoDeleteObjectsCustomResourceProvider": {
            "id": "Custom::S3AutoDeleteObjectsCustomResourceProvider",
            "path": "SecurityFindingGeneratorStack/Custom::S3AutoDeleteObjectsCustomResourceProvider",
            "children": {
              "Staging": {
                "id": "Staging",
                "path": "SecurityFindingGeneratorStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Staging",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.AssetStaging",
                  "version": "2.118.0"
                }
              },
              "Role": {
                "id": "Role",
                "path": "SecurityFindingGeneratorStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Role",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.CfnResource",
                  "version": "2.118.0"
                }
              },
              "Handler": {
                "id": "Handler",
                "path": "SecurityFindingGeneratorStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Handler",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.CfnResource",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.CustomResourceProviderBase",
              "version": "2.118.0"
            }
          },
          "security_demo_s3_user_data_bucket_parameter": {
            "id": "security_demo_s3_user_data_bucket_parameter",
            "path": "SecurityFindingGeneratorStack/security_demo_s3_user_data_bucket_parameter",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/security_demo_s3_user_data_bucket_parameter/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::SSM::Parameter",
                  "aws:cdk:cloudformation:props": {
                    "allowedPattern": ".*",
                    "description": "Bucket name to use to enable for CloudTrail.",
                    "name": "/security_demo_s3_user_data_bucket_parameter",
                    "tags": {
                      "security-demo": "true"
                    },
                    "tier": "Standard",
                    "type": "String",
                    "value": {
                      "Ref": "securitydemos3userdatabucketC56A23F8"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ssm.CfnParameter",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_ssm.StringParameter",
              "version": "2.118.0"
            }
          },
          "user_data_asset_deployment": {
            "id": "user_data_asset_deployment",
            "path": "SecurityFindingGeneratorStack/user_data_asset_deployment",
            "children": {
              "AwsCliLayer": {
                "id": "AwsCliLayer",
                "path": "SecurityFindingGeneratorStack/user_data_asset_deployment/AwsCliLayer",
                "children": {
                  "Code": {
                    "id": "Code",
                    "path": "SecurityFindingGeneratorStack/user_data_asset_deployment/AwsCliLayer/Code",
                    "children": {
                      "Stage": {
                        "id": "Stage",
                        "path": "SecurityFindingGeneratorStack/user_data_asset_deployment/AwsCliLayer/Code/Stage",
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.AssetStaging",
                          "version": "2.118.0"
                        }
                      },
                      "AssetBucket": {
                        "id": "AssetBucket",
                        "path": "SecurityFindingGeneratorStack/user_data_asset_deployment/AwsCliLayer/Code/AssetBucket",
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_s3.BucketBase",
                          "version": "2.118.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_s3_assets.Asset",
                      "version": "2.118.0"
                    }
                  },
                  "Resource": {
                    "id": "Resource",
                    "path": "SecurityFindingGeneratorStack/user_data_asset_deployment/AwsCliLayer/Resource",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::Lambda::LayerVersion",
                      "aws:cdk:cloudformation:props": {
                        "content": {
                          "s3Bucket": {
                            "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
                          },
                          "s3Key": "3322b7049fb0ed2b7cbb644a2ada8d1116ff80c32dca89e6ada846b5de26f961.zip"
                        },
                        "description": "/opt/awscli/aws"
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_lambda.CfnLayerVersion",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.lambda_layer_awscli.AwsCliLayer",
                  "version": "2.118.0"
                }
              },
              "CustomResourceHandler": {
                "id": "CustomResourceHandler",
                "path": "SecurityFindingGeneratorStack/user_data_asset_deployment/CustomResourceHandler",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_lambda.SingletonFunction",
                  "version": "2.118.0"
                }
              },
              "Asset1": {
                "id": "Asset1",
                "path": "SecurityFindingGeneratorStack/user_data_asset_deployment/Asset1",
                "children": {
                  "Stage": {
                    "id": "Stage",
                    "path": "SecurityFindingGeneratorStack/user_data_asset_deployment/Asset1/Stage",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.AssetStaging",
                      "version": "2.118.0"
                    }
                  },
                  "AssetBucket": {
                    "id": "AssetBucket",
                    "path": "SecurityFindingGeneratorStack/user_data_asset_deployment/Asset1/AssetBucket",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_s3.BucketBase",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_s3_assets.Asset",
                  "version": "2.118.0"
                }
              },
              "CustomResource": {
                "id": "CustomResource",
                "path": "SecurityFindingGeneratorStack/user_data_asset_deployment/CustomResource",
                "children": {
                  "Default": {
                    "id": "Default",
                    "path": "SecurityFindingGeneratorStack/user_data_asset_deployment/CustomResource/Default",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.CfnResource",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.CustomResource",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_s3_deployment.BucketDeployment",
              "version": "2.118.0"
            }
          },
          "Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C": {
            "id": "Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C",
            "path": "SecurityFindingGeneratorStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C",
            "children": {
              "ServiceRole": {
                "id": "ServiceRole",
                "path": "SecurityFindingGeneratorStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/ServiceRole",
                "children": {
                  "ImportServiceRole": {
                    "id": "ImportServiceRole",
                    "path": "SecurityFindingGeneratorStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/ServiceRole/ImportServiceRole",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.Resource",
                      "version": "2.118.0"
                    }
                  },
                  "Resource": {
                    "id": "Resource",
                    "path": "SecurityFindingGeneratorStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/ServiceRole/Resource",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::IAM::Role",
                      "aws:cdk:cloudformation:props": {
                        "assumeRolePolicyDocument": {
                          "Statement": [
                            {
                              "Action": "sts:AssumeRole",
                              "Effect": "Allow",
                              "Principal": {
                                "Service": "lambda.amazonaws.com"
                              }
                            }
                          ],
                          "Version": "2012-10-17"
                        },
                        "managedPolicyArns": [
                          {
                            "Fn::Join": [
                              "",
                              [
                                "arn:",
                                {
                                  "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
                              ]
                            ]
                          }
                        ],
                        "tags": [
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ]
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_iam.CfnRole",
                      "version": "2.118.0"
                    }
                  },
                  "DefaultPolicy": {
                    "id": "DefaultPolicy",
                    "path": "SecurityFindingGeneratorStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/ServiceRole/DefaultPolicy",
                    "children": {
                      "Resource": {
                        "id": "Resource",
                        "path": "SecurityFindingGeneratorStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/ServiceRole/DefaultPolicy/Resource",
                        "attributes": {
                          "aws:cdk:cloudformation:type": "AWS::IAM::Policy",
                          "aws:cdk:cloudformation:props": {
                            "policyDocument": {
                              "Statement": [
                                {
                                  "Action": [
                                    "s3:GetBucket*",
                                    "s3:GetObject*",
                                    "s3:List*"
                                  ],
                                  "Effect": "Allow",
                                  "Resource": [
                                    {
                                      "Fn::Join": [
                                        "",
                                        [
                                          "arn:",
                                          {
                                            "Ref": "AWS::Partition"
                                          },
                                          ":s3:::",
                                          {
                                            "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
                                          },
                                          "/*"
                                        ]
                                      ]
                                    },
                                    {
                                      "Fn::Join": [
                                        "",
                                        [
                                          "arn:",
                                          {
                                            "Ref": "AWS::Partition"
                                          },
                                          ":s3:::",
                                          {
                                            "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
                                          }
                                        ]
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "Action": [
                                    "s3:Abort*",
                                    "s3:DeleteObject*",
                                    "s3:GetBucket*",
                                    "s3:GetObject*",
                                    "s3:List*",
                                    "s3:PutObject",
                                    "s3:PutObjectLegalHold",
                                    "s3:PutObjectRetention",
                                    "s3:PutObjectTagging",
                                    "s3:PutObjectVersionTagging"
                                  ],
                                  "Effect": "Allow",
                                  "Resource": [
                                    {
                                      "Fn::GetAtt": [
                                        "securitydemos3userdatabucketC56A23F8",
                                        "Arn"
                                      ]
                                    },
                                    {
                                      "Fn::Join": [
                                        "",
                                        [
                                          {
                                            "Fn::GetAtt": [
                                              "securitydemos3userdatabucketC56A23F8",
                                              "Arn"
                                            ]
                                          },
                                          "/*"
                                        ]
                                      ]
                                    }
                                  ]
                                },
                                {
                                  "Action": [
                                    "kms:Decrypt",
                                    "kms:DescribeKey",
                                    "kms:Encrypt",
                                    "kms:GenerateDataKey*",
                                    "kms:ReEncrypt*"
                                  ],
                                  "Effect": "Allow",
                                  "Resource": {
                                    "Fn::GetAtt": [
                                      "securitydemos3userdatakey646F9E0C",
                                      "Arn"
                                    ]
                                  }
                                }
                              ],
                              "Version": "2012-10-17"
                            },
                            "policyName": "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRoleDefaultPolicy88902FDF",
                            "roles": [
                              {
                                "Ref": "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265"
                              }
                            ]
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_iam.CfnPolicy",
                          "version": "2.118.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_iam.Policy",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.Role",
                  "version": "2.118.0"
                }
              },
              "Code": {
                "id": "Code",
                "path": "SecurityFindingGeneratorStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/Code",
                "children": {
                  "Stage": {
                    "id": "Stage",
                    "path": "SecurityFindingGeneratorStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/Code/Stage",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.AssetStaging",
                      "version": "2.118.0"
                    }
                  },
                  "AssetBucket": {
                    "id": "AssetBucket",
                    "path": "SecurityFindingGeneratorStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/Code/AssetBucket",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_s3.BucketBase",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_s3_assets.Asset",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::Lambda::Function",
                  "aws:cdk:cloudformation:props": {
                    "code": {
                      "s3Bucket": {
                        "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
                      },
                      "s3Key": "e976a796f036a5efbf44b99e44cfb5a961df08d8dbf7cd37e60bf216fb982a00.zip"
                    },
                    "environment": {
                      "variables": {
                        "AWS_CA_BUNDLE": "/etc/pki/ca-trust/extracted/pem/tls-ca-bundle.pem"
                      }
                    },
                    "handler": "index.handler",
                    "layers": [
                      {
                        "Ref": "userdataassetdeploymentAwsCliLayer6CA537FA"
                      }
                    ],
                    "role": {
                      "Fn::GetAtt": [
                        "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265",
                        "Arn"
                      ]
                    },
                    "runtime": "python3.9",
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ],
                    "timeout": 900
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_lambda.CfnFunction",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_lambda.Function",
              "version": "2.118.0"
            }
          },
          "EC2DemoAdminAccess": {
            "id": "EC2DemoAdminAccess",
            "path": "SecurityFindingGeneratorStack/EC2DemoAdminAccess",
            "constructInfo": {
              "fqn": "aws-cdk-lib.Resource",
              "version": "2.118.0"
            }
          },
          "lambdaAmazonEC2RoleforSSMPolicy": {
            "id": "lambdaAmazonEC2RoleforSSMPolicy",
            "path": "SecurityFindingGeneratorStack/lambdaAmazonEC2RoleforSSMPolicy",
            "constructInfo": {
              "fqn": "aws-cdk-lib.Resource",
              "version": "2.118.0"
            }
          },
          "ec2_instance_module_role": {
            "id": "ec2_instance_module_role",
            "path": "SecurityFindingGeneratorStack/ec2_instance_module_role",
            "children": {
              "Importec2_instance_module_role": {
                "id": "Importec2_instance_module_role",
                "path": "SecurityFindingGeneratorStack/ec2_instance_module_role/Importec2_instance_module_role",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.Resource",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/ec2_instance_module_role/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::IAM::Role",
                  "aws:cdk:cloudformation:props": {
                    "assumeRolePolicyDocument": {
                      "Statement": [
                        {
                          "Action": "sts:AssumeRole",
                          "Effect": "Allow",
                          "Principal": {
                            "Service": "ec2.amazonaws.com"
                          }
                        }
                      ],
                      "Version": "2012-10-17"
                    },
                    "managedPolicyArns": [
                      "arn:aws:iam::aws:policy/AdministratorAccess",
                      "arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore"
                    ],
                    "roleName": "ec2-security-demo-role",
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.CfnRole",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_iam.Role",
              "version": "2.118.0"
            }
          },
          "EC2CreateModuleManagedPolicy": {
            "id": "EC2CreateModuleManagedPolicy",
            "path": "SecurityFindingGeneratorStack/EC2CreateModuleManagedPolicy",
            "children": {
              "ImportedEC2CreateModuleManagedPolicy": {
                "id": "ImportedEC2CreateModuleManagedPolicy",
                "path": "SecurityFindingGeneratorStack/EC2CreateModuleManagedPolicy/ImportedEC2CreateModuleManagedPolicy",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.Resource",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/EC2CreateModuleManagedPolicy/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::IAM::ManagedPolicy",
                  "aws:cdk:cloudformation:props": {
                    "description": "Policy for EC2 instance profile role.",
                    "managedPolicyName": "ec2-inspector-demo-policy",
                    "path": "/",
                    "policyDocument": {
                      "Statement": [
                        {
                          "Action": [
                            "kms:Decrypt",
                            "kms:DescribeKey",
                            "kms:Encrypt",
                            "kms:GenerateDataKey"
                          ],
                          "Effect": "Allow",
                          "Resource": {
                            "Fn::Join": [
                              "",
                              [
                                "arn:",
                                {
                                  "Ref": "AWS::Partition"
                                },
                                ":kms:",
                                {
                                  "Ref": "AWS::Region"
                                },
                                ":",
                                {
                                  "Ref": "AWS::AccountId"
                                },
                                ":key/*"
                              ]
                            ]
                          },
                          "Sid": "KMSAllow"
                        },
                        {
                          "Action": [
                            "ec2:CreateNetworkInterface",
                            "ec2:DeleteNetworkInterface",
                            "ec2:DescribeNetworkInterfaces"
                          ],
                          "Effect": "Allow",
                          "Resource": [
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":ec2:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":network-interface/*"
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":ec2:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":security-group/*"
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":ec2:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":subnet/*"
                                ]
                              ]
                            }
                          ],
                          "Sid": "EC2Allow"
                        },
                        {
                          "Action": [
                            "ssm:GetParameter",
                            "ssm:GetParameters",
                            "ssm:PutParameter"
                          ],
                          "Effect": "Allow",
                          "Resource": {
                            "Fn::Join": [
                              "",
                              [
                                "arn:",
                                {
                                  "Ref": "AWS::Partition"
                                },
                                ":ssm:",
                                {
                                  "Ref": "AWS::Region"
                                },
                                ":",
                                {
                                  "Ref": "AWS::AccountId"
                                },
                                ":parameter",
                                {
                                  "Ref": "securitydemoparameter0ACE2DB9"
                                }
                              ]
                            ]
                          },
                          "Sid": "SSMAllow"
                        }
                      ],
                      "Version": "2012-10-17"
                    },
                    "roles": [
                      {
                        "Ref": "ec2instancemodulerole43B94AC9"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.CfnManagedPolicy",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_iam.ManagedPolicy",
              "version": "2.118.0"
            }
          },
          "demo_ec2_instance": {
            "id": "demo_ec2_instance",
            "path": "SecurityFindingGeneratorStack/demo_ec2_instance",
            "children": {
              "InstanceProfile": {
                "id": "InstanceProfile",
                "path": "SecurityFindingGeneratorStack/demo_ec2_instance/InstanceProfile",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::IAM::InstanceProfile",
                  "aws:cdk:cloudformation:props": {
                    "roles": [
                      {
                        "Ref": "ec2instancemodulerole43B94AC9"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.CfnInstanceProfile",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/demo_ec2_instance/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::EC2::Instance",
                  "aws:cdk:cloudformation:props": {
                    "availabilityZone": {
                      "Fn::Select": [
                        0,
                        {
                          "Fn::GetAZs": ""
                        }
                      ]
                    },
                    "blockDeviceMappings": [
                      {
                        "deviceName": "/dev/xvda",
                        "ebs": {
                          "deleteOnTermination": true,
                          "encrypted": true,
                          "volumeSize": 30,
                          "volumeType": "gp2"
                        }
                      }
                    ],
                    "iamInstanceProfile": {
                      "Ref": "demoec2instanceInstanceProfile75C2C5AE"
                    },
                    "imageId": {
                      "Ref": "SsmParameterValueawsserviceamiamazonlinuxlatestamzn2amihvmx8664gp2C96584B6F00A464EAD1953AFF4B05118Parameter"
                    },
                    "instanceType": "t3.medium",
                    "securityGroupIds": [
                      {
                        "Fn::GetAtt": [
                          "securitydemosg72A385FB",
                          "GroupId"
                        ]
                      }
                    ],
                    "subnetId": {
                      "Ref": "securitydemovpcdemoprivatenatsubnetSubnet1SubnetF2EA78AC"
                    },
                    "tags": [
                      {
                        "key": "Name",
                        "value": "security_services_finding_demo"
                      },
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ],
                    "userData": {
                      "Fn::Base64": {
                        "Fn::Join": [
                          "",
                          [
                            "#!/bin/bash\nsecurity_service=$(aws ssm get-parameter --name ",
                            {
                              "Ref": "securitydemoparameter0ACE2DB9"
                            },
                            " --region ",
                            {
                              "Ref": "AWS::Region"
                            },
                            " --output text --query Parameter.Value)\nsudo aws s3 cp s3://",
                            {
                              "Ref": "securitydemos3userdatabucketC56A23F8"
                            },
                            "/ec2-user-data-demo/$security_service-user-data.sh /home/ec2-user/\nsudo chmod +x /home/ec2-user/$security_service-user-data.sh\nsudo /home/ec2-user/$security_service-user-data.sh"
                          ]
                        ]
                      }
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.CfnInstance",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_ec2.Instance",
              "version": "2.118.0"
            }
          },
          "SsmParameterValue:--aws--service--ami-amazon-linux-latest--amzn2-ami-hvm-x86_64-gp2:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter": {
            "id": "SsmParameterValue:--aws--service--ami-amazon-linux-latest--amzn2-ami-hvm-x86_64-gp2:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter",
            "path": "SecurityFindingGeneratorStack/SsmParameterValue:--aws--service--ami-amazon-linux-latest--amzn2-ami-hvm-x86_64-gp2:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter",
            "constructInfo": {
              "fqn": "aws-cdk-lib.CfnParameter",
              "version": "2.118.0"
            }
          },
          "SsmParameterValue:--aws--service--ami-amazon-linux-latest--amzn2-ami-hvm-x86_64-gp2:C96584B6-F00A-464E-AD19-53AFF4B05118": {
            "id": "SsmParameterValue:--aws--service--ami-amazon-linux-latest--amzn2-ami-hvm-x86_64-gp2:C96584B6-F00A-464E-AD19-53AFF4B05118",
            "path": "SecurityFindingGeneratorStack/SsmParameterValue:--aws--service--ami-amazon-linux-latest--amzn2-ami-hvm-x86_64-gp2:C96584B6-F00A-464E-AD19-53AFF4B05118",
            "constructInfo": {
              "fqn": "aws-cdk-lib.Resource",
              "version": "2.118.0"
            }
          },
          "lambdaECRCleanupExecutionPolicy": {
            "id": "lambdaECRCleanupExecutionPolicy",
            "path": "SecurityFindingGeneratorStack/lambdaECRCleanupExecutionPolicy",
            "constructInfo": {
              "fqn": "aws-cdk-lib.Resource",
              "version": "2.118.0"
            }
          },
          "lambdaAmazonEC2ContainerRegistryFullAccessPolicy": {
            "id": "lambdaAmazonEC2ContainerRegistryFullAccessPolicy",
            "path": "SecurityFindingGeneratorStack/lambdaAmazonEC2ContainerRegistryFullAccessPolicy",
            "constructInfo": {
              "fqn": "aws-cdk-lib.Resource",
              "version": "2.118.0"
            }
          },
          "lambdaECRCleanupVPCPolicy": {
            "id": "lambdaECRCleanupVPCPolicy",
            "path": "SecurityFindingGeneratorStack/lambdaECRCleanupVPCPolicy",
            "constructInfo": {
              "fqn": "aws-cdk-lib.Resource",
              "version": "2.118.0"
            }
          },
          "lambda_ecr_cleanup_role": {
            "id": "lambda_ecr_cleanup_role",
            "path": "SecurityFindingGeneratorStack/lambda_ecr_cleanup_role",
            "children": {
              "Importlambda_ecr_cleanup_role": {
                "id": "Importlambda_ecr_cleanup_role",
                "path": "SecurityFindingGeneratorStack/lambda_ecr_cleanup_role/Importlambda_ecr_cleanup_role",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.Resource",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/lambda_ecr_cleanup_role/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::IAM::Role",
                  "aws:cdk:cloudformation:props": {
                    "assumeRolePolicyDocument": {
                      "Statement": [
                        {
                          "Action": "sts:AssumeRole",
                          "Effect": "Allow",
                          "Principal": {
                            "Service": "lambda.amazonaws.com"
                          }
                        }
                      ],
                      "Version": "2012-10-17"
                    },
                    "managedPolicyArns": [
                      "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
                      "arn:aws:iam::aws:policy/AmazonEC2ContainerRegistryFullAccess",
                      "arn:aws:iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"
                    ],
                    "roleName": "ecr-lambda-cleanup-role",
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.CfnRole",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_iam.Role",
              "version": "2.118.0"
            }
          },
          "lambdaECRCleanupManagedPolicy": {
            "id": "lambdaECRCleanupManagedPolicy",
            "path": "SecurityFindingGeneratorStack/lambdaECRCleanupManagedPolicy",
            "children": {
              "ImportedlambdaECRCleanupManagedPolicy": {
                "id": "ImportedlambdaECRCleanupManagedPolicy",
                "path": "SecurityFindingGeneratorStack/lambdaECRCleanupManagedPolicy/ImportedlambdaECRCleanupManagedPolicy",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.Resource",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/lambdaECRCleanupManagedPolicy/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::IAM::ManagedPolicy",
                  "aws:cdk:cloudformation:props": {
                    "description": "Cleanup deployed ECR Container image resources",
                    "managedPolicyName": "ecr-cleanup-policy",
                    "path": "/",
                    "policyDocument": {
                      "Statement": [
                        {
                          "Action": [
                            "kms:Decrypt",
                            "kms:Describe*",
                            "kms:GenerateDataKey"
                          ],
                          "Effect": "Allow",
                          "Resource": {
                            "Fn::Join": [
                              "",
                              [
                                "arn:",
                                {
                                  "Ref": "AWS::Partition"
                                },
                                ":kms:",
                                {
                                  "Ref": "AWS::Region"
                                },
                                ":",
                                {
                                  "Ref": "AWS::AccountId"
                                },
                                ":key/*"
                              ]
                            ]
                          },
                          "Sid": "KMSDecrypt"
                        },
                        {
                          "Action": "iam:PassRole",
                          "Effect": "Allow",
                          "Resource": {
                            "Fn::GetAtt": [
                              "ec2instancemodulerole43B94AC9",
                              "Arn"
                            ]
                          },
                          "Sid": "IAMPassRole"
                        },
                        {
                          "Action": [
                            "ec2:AttachNetworkInterface",
                            "ec2:CreateNetworkInterface",
                            "ec2:DeleteNetworkInterface",
                            "ec2:Describe*",
                            "ec2:RunInstances",
                            "ec2:TerminateInstances"
                          ],
                          "Effect": "Allow",
                          "Resource": {
                            "Fn::Join": [
                              "",
                              [
                                "arn:",
                                {
                                  "Ref": "AWS::Partition"
                                },
                                ":ec2:",
                                {
                                  "Ref": "AWS::Region"
                                },
                                ":",
                                {
                                  "Ref": "AWS::AccountId"
                                },
                                ":*"
                              ]
                            ]
                          },
                          "Sid": "EC2Allow"
                        },
                        {
                          "Action": "ssm:SendCommand",
                          "Effect": "Allow",
                          "Resource": [
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":ec2:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":instance/*"
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":s3:::*"
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":ssm:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":document/*"
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":ssm:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":managed-instance/*"
                                ]
                              ]
                            }
                          ],
                          "Sid": "SSMExecute"
                        }
                      ],
                      "Version": "2012-10-17"
                    },
                    "roles": [
                      {
                        "Ref": "lambdaecrcleanuprole6D9E85AE"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.CfnManagedPolicy",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_iam.ManagedPolicy",
              "version": "2.118.0"
            }
          },
          "ecr_cleanup_function": {
            "id": "ecr_cleanup_function",
            "path": "SecurityFindingGeneratorStack/ecr_cleanup_function",
            "children": {
              "Code": {
                "id": "Code",
                "path": "SecurityFindingGeneratorStack/ecr_cleanup_function/Code",
                "children": {
                  "Stage": {
                    "id": "Stage",
                    "path": "SecurityFindingGeneratorStack/ecr_cleanup_function/Code/Stage",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.AssetStaging",
                      "version": "2.118.0"
                    }
                  },
                  "AssetBucket": {
                    "id": "AssetBucket",
                    "path": "SecurityFindingGeneratorStack/ecr_cleanup_function/Code/AssetBucket",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_s3.BucketBase",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_s3_assets.Asset",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/ecr_cleanup_function/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::Lambda::Function",
                  "aws:cdk:cloudformation:props": {
                    "code": {
                      "s3Bucket": {
                        "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
                      },
                      "s3Key": "c5d657ac0a3bfceb5cf97ffa7107787ad44e6954eff569e30027efd0d65fbb0a.zip"
                    },
                    "description": "Function to clean up ECR container images built by Inspector demo.",
                    "handler": "ecr_cleanup.lambda_handler",
                    "memorySize": 1024,
                    "role": {
                      "Fn::GetAtt": [
                        "lambdaecrcleanuprole6D9E85AE",
                        "Arn"
                      ]
                    },
                    "runtime": "python3.9",
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ],
                    "timeout": 300
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_lambda.CfnFunction",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_lambda.Function",
              "version": "2.118.0"
            }
          },
          "ecr_rule": {
            "id": "ecr_rule",
            "path": "SecurityFindingGeneratorStack/ecr_rule",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/ecr_rule/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::Events::Rule",
                  "aws:cdk:cloudformation:props": {
                    "description": "EventBridge Rule cron job to invoke lambda function to cleanup images in the vuln-images ECR repository.",
                    "scheduleExpression": "cron(0 2 2 * ? *)",
                    "state": "ENABLED",
                    "targets": [
                      {
                        "id": "Target0",
                        "arn": {
                          "Fn::GetAtt": [
                            "ecrcleanupfunctionF139BA80",
                            "Arn"
                          ]
                        }
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_events.CfnRule",
                  "version": "2.118.0"
                }
              },
              "AllowEventRuleSecurityFindingGeneratorStackecrcleanupfunction3CF36460": {
                "id": "AllowEventRuleSecurityFindingGeneratorStackecrcleanupfunction3CF36460",
                "path": "SecurityFindingGeneratorStack/ecr_rule/AllowEventRuleSecurityFindingGeneratorStackecrcleanupfunction3CF36460",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::Lambda::Permission",
                  "aws:cdk:cloudformation:props": {
                    "action": "lambda:InvokeFunction",
                    "functionName": {
                      "Fn::GetAtt": [
                        "ecrcleanupfunctionF139BA80",
                        "Arn"
                      ]
                    },
                    "principal": "events.amazonaws.com",
                    "sourceArn": {
                      "Fn::GetAtt": [
                        "ecrrule9A3A65CE",
                        "Arn"
                      ]
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_lambda.CfnPermission",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_events.Rule",
              "version": "2.118.0"
            }
          },
          "ecr_ResourceProvider": {
            "id": "ecr_ResourceProvider",
            "path": "SecurityFindingGeneratorStack/ecr_ResourceProvider",
            "children": {
              "framework-onEvent": {
                "id": "framework-onEvent",
                "path": "SecurityFindingGeneratorStack/ecr_ResourceProvider/framework-onEvent",
                "children": {
                  "ServiceRole": {
                    "id": "ServiceRole",
                    "path": "SecurityFindingGeneratorStack/ecr_ResourceProvider/framework-onEvent/ServiceRole",
                    "children": {
                      "ImportServiceRole": {
                        "id": "ImportServiceRole",
                        "path": "SecurityFindingGeneratorStack/ecr_ResourceProvider/framework-onEvent/ServiceRole/ImportServiceRole",
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.Resource",
                          "version": "2.118.0"
                        }
                      },
                      "Resource": {
                        "id": "Resource",
                        "path": "SecurityFindingGeneratorStack/ecr_ResourceProvider/framework-onEvent/ServiceRole/Resource",
                        "attributes": {
                          "aws:cdk:cloudformation:type": "AWS::IAM::Role",
                          "aws:cdk:cloudformation:props": {
                            "assumeRolePolicyDocument": {
                              "Statement": [
                                {
                                  "Action": "sts:AssumeRole",
                                  "Effect": "Allow",
                                  "Principal": {
                                    "Service": "lambda.amazonaws.com"
                                  }
                                }
                              ],
                              "Version": "2012-10-17"
                            },
                            "managedPolicyArns": [
                              {
                                "Fn::Join": [
                                  "",
                                  [
                                    "arn:",
                                    {
                                      "Ref": "AWS::Partition"
                                    },
                                    ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
                                  ]
                                ]
                              }
                            ],
                            "tags": [
                              {
                                "key": "security-demo",
                                "value": "true"
                              }
                            ]
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_iam.CfnRole",
                          "version": "2.118.0"
                        }
                      },
                      "DefaultPolicy": {
                        "id": "DefaultPolicy",
                        "path": "SecurityFindingGeneratorStack/ecr_ResourceProvider/framework-onEvent/ServiceRole/DefaultPolicy",
                        "children": {
                          "Resource": {
                            "id": "Resource",
                            "path": "SecurityFindingGeneratorStack/ecr_ResourceProvider/framework-onEvent/ServiceRole/DefaultPolicy/Resource",
                            "attributes": {
                              "aws:cdk:cloudformation:type": "AWS::IAM::Policy",
                              "aws:cdk:cloudformation:props": {
                                "policyDocument": {
                                  "Statement": [
                                    {
                                      "Action": "lambda:InvokeFunction",
                                      "Effect": "Allow",
                                      "Resource": [
                                        {
                                          "Fn::GetAtt": [
                                            "ecrcleanupfunctionF139BA80",
                                            "Arn"
                                          ]
                                        },
                                        {
                                          "Fn::Join": [
                                            "",
                                            [
                                              {
                                                "Fn::GetAtt": [
                                                  "ecrcleanupfunctionF139BA80",
                                                  "Arn"
                                                ]
                                              },
                                              ":*"
                                            ]
                                          ]
                                        }
                                      ]
                                    }
                                  ],
                                  "Version": "2012-10-17"
                                },
                                "policyName": "ecrResourceProviderframeworkonEventServiceRoleDefaultPolicyAAA6F566",
                                "roles": [
                                  {
                                    "Ref": "ecrResourceProviderframeworkonEventServiceRole83957642"
                                  }
                                ]
                              }
                            },
                            "constructInfo": {
                              "fqn": "aws-cdk-lib.aws_iam.CfnPolicy",
                              "version": "2.118.0"
                            }
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_iam.Policy",
                          "version": "2.118.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_iam.Role",
                      "version": "2.118.0"
                    }
                  },
                  "Code": {
                    "id": "Code",
                    "path": "SecurityFindingGeneratorStack/ecr_ResourceProvider/framework-onEvent/Code",
                    "children": {
                      "Stage": {
                        "id": "Stage",
                        "path": "SecurityFindingGeneratorStack/ecr_ResourceProvider/framework-onEvent/Code/Stage",
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.AssetStaging",
                          "version": "2.118.0"
                        }
                      },
                      "AssetBucket": {
                        "id": "AssetBucket",
                        "path": "SecurityFindingGeneratorStack/ecr_ResourceProvider/framework-onEvent/Code/AssetBucket",
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_s3.BucketBase",
                          "version": "2.118.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_s3_assets.Asset",
                      "version": "2.118.0"
                    }
                  },
                  "Resource": {
                    "id": "Resource",
                    "path": "SecurityFindingGeneratorStack/ecr_ResourceProvider/framework-onEvent/Resource",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::Lambda::Function",
                      "aws:cdk:cloudformation:props": {
                        "code": {
                          "s3Bucket": {
                            "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
                          },
                          "s3Key": "7382a0addb9f34974a1ea6c6c9b063882af874828f366f5c93b2b7b64db15c94.zip"
                        },
                        "description": "AWS CDK resource provider framework - onEvent (SecurityFindingGeneratorStack/ecr_ResourceProvider)",
                        "environment": {
                          "variables": {
                            "USER_ON_EVENT_FUNCTION_ARN": {
                              "Fn::GetAtt": [
                                "ecrcleanupfunctionF139BA80",
                                "Arn"
                              ]
                            }
                          }
                        },
                        "handler": "framework.onEvent",
                        "role": {
                          "Fn::GetAtt": [
                            "ecrResourceProviderframeworkonEventServiceRole83957642",
                            "Arn"
                          ]
                        },
                        "runtime": "nodejs18.x",
                        "tags": [
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ],
                        "timeout": 900
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_lambda.CfnFunction",
                      "version": "2.118.0"
                    }
                  },
                  "LogRetention": {
                    "id": "LogRetention",
                    "path": "SecurityFindingGeneratorStack/ecr_ResourceProvider/framework-onEvent/LogRetention",
                    "children": {
                      "Resource": {
                        "id": "Resource",
                        "path": "SecurityFindingGeneratorStack/ecr_ResourceProvider/framework-onEvent/LogRetention/Resource",
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.CfnResource",
                          "version": "2.118.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_logs.LogRetention",
                      "version": "2.118.0"
                    }
                  },
                  "LogGroup": {
                    "id": "LogGroup",
                    "path": "SecurityFindingGeneratorStack/ecr_ResourceProvider/framework-onEvent/LogGroup",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.Resource",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_lambda.Function",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.custom_resources.Provider",
              "version": "2.118.0"
            }
          },
          "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a": {
            "id": "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a",
            "path": "SecurityFindingGeneratorStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a",
            "children": {
              "Code": {
                "id": "Code",
                "path": "SecurityFindingGeneratorStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Code",
                "children": {
                  "Stage": {
                    "id": "Stage",
                    "path": "SecurityFindingGeneratorStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Code/Stage",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.AssetStaging",
                      "version": "2.118.0"
                    }
                  },
                  "AssetBucket": {
                    "id": "AssetBucket",
                    "path": "SecurityFindingGeneratorStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Code/AssetBucket",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_s3.BucketBase",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_s3_assets.Asset",
                  "version": "2.118.0"
                }
              },
              "ServiceRole": {
                "id": "ServiceRole",
                "path": "SecurityFindingGeneratorStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole",
                "children": {
                  "ImportServiceRole": {
                    "id": "ImportServiceRole",
                    "path": "SecurityFindingGeneratorStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/ImportServiceRole",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.Resource",
                      "version": "2.118.0"
                    }
                  },
                  "Resource": {
                    "id": "Resource",
                    "path": "SecurityFindingGeneratorStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/Resource",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::IAM::Role",
                      "aws:cdk:cloudformation:props": {
                        "assumeRolePolicyDocument": {
                          "Statement": [
                            {
                              "Action": "sts:AssumeRole",
                              "Effect": "Allow",
                              "Principal": {
                                "Service": "lambda.amazonaws.com"
                              }
                            }
                          ],
                          "Version": "2012-10-17"
                        },
                        "managedPolicyArns": [
                          {
                            "Fn::Join": [
                              "",
                              [
                                "arn:",
                                {
                                  "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
                              ]
                            ]
                          }
                        ],
                        "tags": [
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ]
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_iam.CfnRole",
                      "version": "2.118.0"
                    }
                  },
                  "DefaultPolicy": {
                    "id": "DefaultPolicy",
                    "path": "SecurityFindingGeneratorStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/DefaultPolicy",
                    "children": {
                      "Resource": {
                        "id": "Resource",
                        "path": "SecurityFindingGeneratorStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/ServiceRole/DefaultPolicy/Resource",
                        "attributes": {
                          "aws:cdk:cloudformation:type": "AWS::IAM::Policy",
                          "aws:cdk:cloudformation:props": {
                            "policyDocument": {
                              "Statement": [
                                {
                                  "Action": [
                                    "logs:DeleteRetentionPolicy",
                                    "logs:PutRetentionPolicy"
                                  ],
                                  "Effect": "Allow",
                                  "Resource": "*"
                                }
                              ],
                              "Version": "2012-10-17"
                            },
                            "policyName": "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRoleDefaultPolicyADDA7DEB",
                            "roles": [
                              {
                                "Ref": "LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8aServiceRole9741ECFB"
                              }
                            ]
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_iam.CfnPolicy",
                          "version": "2.118.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_iam.Policy",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.Role",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/LogRetentionaae0aa3c5b4d4f87b02d85b201efdd8a/Resource",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.CfnResource",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "constructs.Construct",
              "version": "10.3.0"
            }
          },
          "ecr_cleanup_custom_action": {
            "id": "ecr_cleanup_custom_action",
            "path": "SecurityFindingGeneratorStack/ecr_cleanup_custom_action",
            "children": {
              "Default": {
                "id": "Default",
                "path": "SecurityFindingGeneratorStack/ecr_cleanup_custom_action/Default",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.CfnResource",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.CustomResource",
              "version": "2.118.0"
            }
          },
          "guardduty_condition": {
            "id": "guardduty_condition",
            "path": "SecurityFindingGeneratorStack/guardduty_condition",
            "constructInfo": {
              "fqn": "aws-cdk-lib.CfnCondition",
              "version": "2.118.0"
            }
          },
          "db_pw_parameter": {
            "id": "db_pw_parameter",
            "path": "SecurityFindingGeneratorStack/db_pw_parameter",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/db_pw_parameter/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::SSM::Parameter",
                  "aws:cdk:cloudformation:props": {
                    "allowedPattern": ".*",
                    "description": "This is an example secret for generating GuardDuty findings.",
                    "name": "gd_prod_dbpwd_sample",
                    "tags": {
                      "security-demo": "true"
                    },
                    "tier": "Standard",
                    "type": "String",
                    "value": "NA"
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ssm.CfnParameter",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_ssm.StringParameter",
              "version": "2.118.0"
            }
          },
          "security_demo_kms_key": {
            "id": "security_demo_kms_key",
            "path": "SecurityFindingGeneratorStack/security_demo_kms_key",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/security_demo_kms_key/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::KMS::Key",
                  "aws:cdk:cloudformation:props": {
                    "description": "KMS key for security finding demo.",
                    "enableKeyRotation": true,
                    "keyPolicy": {
                      "Statement": [
                        {
                          "Action": "kms:*",
                          "Effect": "Allow",
                          "Principal": {
                            "AWS": {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":iam::",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":root"
                                ]
                              ]
                            }
                          },
                          "Resource": "*"
                        }
                      ],
                      "Version": "2012-10-17"
                    },
                    "pendingWindowInDays": 7,
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_kms.CfnKey",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_kms.Key",
              "version": "2.118.0"
            }
          },
          "security_service_demo_bucket": {
            "id": "security_service_demo_bucket",
            "path": "SecurityFindingGeneratorStack/security_service_demo_bucket",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/security_service_demo_bucket/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::S3::Bucket",
                  "aws:cdk:cloudformation:props": {
                    "bucketEncryption": {
                      "serverSideEncryptionConfiguration": [
                        {
                          "bucketKeyEnabled": true,
                          "serverSideEncryptionByDefault": {
                            "sseAlgorithm": "aws:kms",
                            "kmsMasterKeyId": {
                              "Fn::GetAtt": [
                                "securitydemokmskeyA4F361CB",
                                "Arn"
                              ]
                            }
                          }
                        }
                      ]
                    },
                    "bucketName": {
                      "Fn::Join": [
                        "",
                        [
                          "guardduty-finding-demo-",
                          {
                            "Ref": "AWS::AccountId"
                          },
                          "-",
                          {
                            "Ref": "AWS::Region"
                          }
                        ]
                      ]
                    },
                    "loggingConfiguration": {
                      "destinationBucketName": {
                        "Ref": "securitydemos3userdatabucketC56A23F8"
                      },
                      "logFilePrefix": "security_service_demo_access_logging"
                    },
                    "ownershipControls": {
                      "rules": [
                        {
                          "objectOwnership": "BucketOwnerPreferred"
                        }
                      ]
                    },
                    "publicAccessBlockConfiguration": {
                      "blockPublicAcls": true,
                      "blockPublicPolicy": true,
                      "ignorePublicAcls": true,
                      "restrictPublicBuckets": true
                    },
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ],
                    "versioningConfiguration": {
                      "status": "Enabled"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_s3.CfnBucket",
                  "version": "2.118.0"
                }
              },
              "Policy": {
                "id": "Policy",
                "path": "SecurityFindingGeneratorStack/security_service_demo_bucket/Policy",
                "children": {
                  "Resource": {
                    "id": "Resource",
                    "path": "SecurityFindingGeneratorStack/security_service_demo_bucket/Policy/Resource",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::S3::BucketPolicy",
                      "aws:cdk:cloudformation:props": {
                        "bucket": {
                          "Ref": "securityservicedemobucketDB0AACC9"
                        },
                        "policyDocument": {
                          "Statement": [
                            {
                              "Action": "s3:GetBucketAcl",
                              "Effect": "Allow",
                              "Principal": {
                                "Service": "cloudtrail.amazonaws.com"
                              },
                              "Resource": {
                                "Fn::GetAtt": [
                                  "securityservicedemobucketDB0AACC9",
                                  "Arn"
                                ]
                              }
                            },
                            {
                              "Action": "s3:PutObject",
                              "Condition": {
                                "StringEquals": {
                                  "s3:x-amz-acl": "bucket-owner-full-control"
                                },
                                "StringLike": {
                                  "aws:SourceArn": {
                                    "Fn::Join": [
                                      "",
                                      [
                                        "arn:aws:cloudtrail:",
                                        {
                                          "Ref": "AWS::Region"
                                        },
                                        ":",
                                        {
                                          "Ref": "AWS::AccountId"
                                        },
                                        ":trail/*"
                                      ]
                                    ]
                                  }
                                }
                              },
                              "Effect": "Allow",
                              "Principal": {
                                "Service": "cloudtrail.amazonaws.com"
                              },
                              "Resource": {
                                "Fn::Join": [
                                  "",
                                  [
                                    {
                                      "Fn::GetAtt": [
                                        "securityservicedemobucketDB0AACC9",
                                        "Arn"
                                      ]
                                    },
                                    "/*"
                                  ]
                                ]
                              }
                            }
                          ],
                          "Version": "2012-10-17"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_s3.CfnBucketPolicy",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_s3.BucketPolicy",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_s3.Bucket",
              "version": "2.118.0"
            }
          },
          "security_service_demo_bucket_parameter": {
            "id": "security_service_demo_bucket_parameter",
            "path": "SecurityFindingGeneratorStack/security_service_demo_bucket_parameter",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/security_service_demo_bucket_parameter/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::SSM::Parameter",
                  "aws:cdk:cloudformation:props": {
                    "allowedPattern": ".*",
                    "description": "Bucket name for GuardDuty demo",
                    "name": "/security_demo_bucket_parameter",
                    "tags": {
                      "security-demo": "true"
                    },
                    "tier": "Standard",
                    "type": "String",
                    "value": {
                      "Ref": "securityservicedemobucketDB0AACC9"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ssm.CfnParameter",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_ssm.StringParameter",
              "version": "2.118.0"
            }
          },
          "eks_cluster_name_parameter": {
            "id": "eks_cluster_name_parameter",
            "path": "SecurityFindingGeneratorStack/eks_cluster_name_parameter",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/eks_cluster_name_parameter/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::SSM::Parameter",
                  "aws:cdk:cloudformation:props": {
                    "allowedPattern": ".*",
                    "description": "EKS Cluster name for GuardDuty demo",
                    "name": "/security_demo_eks_name_parameter",
                    "tags": {
                      "security-demo": "true"
                    },
                    "tier": "Standard",
                    "type": "String",
                    "value": "GuardDuty-Finding-Demo"
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ssm.CfnParameter",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_ssm.StringParameter",
              "version": "2.118.0"
            }
          },
          "security_demo_dynamodb": {
            "id": "security_demo_dynamodb",
            "path": "SecurityFindingGeneratorStack/security_demo_dynamodb",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/security_demo_dynamodb/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::DynamoDB::Table",
                  "aws:cdk:cloudformation:props": {
                    "attributeDefinitions": [
                      {
                        "attributeName": "name",
                        "attributeType": "S"
                      }
                    ],
                    "keySchema": [
                      {
                        "attributeName": "name",
                        "keyType": "HASH"
                      }
                    ],
                    "provisionedThroughput": {
                      "readCapacityUnits": 5,
                      "writeCapacityUnits": 5
                    },
                    "tableName": "GuardDuty-example-customer-DB",
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_dynamodb.CfnTable",
                  "version": "2.118.0"
                }
              },
              "ScalingRole": {
                "id": "ScalingRole",
                "path": "SecurityFindingGeneratorStack/security_demo_dynamodb/ScalingRole",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.Resource",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_dynamodb.Table",
              "version": "2.118.0"
            }
          },
          "security_demo_dynamodb_parameter": {
            "id": "security_demo_dynamodb_parameter",
            "path": "SecurityFindingGeneratorStack/security_demo_dynamodb_parameter",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/security_demo_dynamodb_parameter/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::SSM::Parameter",
                  "aws:cdk:cloudformation:props": {
                    "allowedPattern": ".*",
                    "description": "DynamoDB table name for GuardDuty finding.",
                    "name": "/security_demo_dynamodb_name",
                    "tags": {
                      "security-demo": "true"
                    },
                    "tier": "Standard",
                    "type": "String",
                    "value": {
                      "Ref": "securitydemodynamodbB3DD1E6E"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ssm.CfnParameter",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_ssm.StringParameter",
              "version": "2.118.0"
            }
          },
          "guardduty_demo_user": {
            "id": "guardduty_demo_user",
            "path": "SecurityFindingGeneratorStack/guardduty_demo_user",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/guardduty_demo_user/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::IAM::User",
                  "aws:cdk:cloudformation:props": {
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ],
                    "userName": "guardduty-demo-user"
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.CfnUser",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_iam.User",
              "version": "2.118.0"
            }
          },
          "compromised_access_key": {
            "id": "compromised_access_key",
            "path": "SecurityFindingGeneratorStack/compromised_access_key",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/compromised_access_key/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::IAM::AccessKey",
                  "aws:cdk:cloudformation:props": {
                    "status": "Inactive",
                    "userName": {
                      "Ref": "guarddutydemouser0B126858"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.CfnAccessKey",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_iam.AccessKey",
              "version": "2.118.0"
            }
          },
          "compromised_access_key_parameter": {
            "id": "compromised_access_key_parameter",
            "path": "SecurityFindingGeneratorStack/compromised_access_key_parameter",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/compromised_access_key_parameter/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::SSM::Parameter",
                  "aws:cdk:cloudformation:props": {
                    "allowedPattern": ".*",
                    "description": {
                      "Fn::Join": [
                        "",
                        [
                          "Demo IAM User access key for ",
                          {
                            "Ref": "guarddutydemouser0B126858"
                          },
                          "."
                        ]
                      ]
                    },
                    "name": "/security_demo_access_key",
                    "tags": {
                      "security-demo": "true"
                    },
                    "tier": "Standard",
                    "type": "String",
                    "value": {
                      "Ref": "compromisedaccesskey16624257"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ssm.CfnParameter",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_ssm.StringParameter",
              "version": "2.118.0"
            }
          },
          "compromised_access_key_secret": {
            "id": "compromised_access_key_secret",
            "path": "SecurityFindingGeneratorStack/compromised_access_key_secret",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/compromised_access_key_secret/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::SecretsManager::Secret",
                  "aws:cdk:cloudformation:props": {
                    "kmsKeyId": {
                      "Fn::GetAtt": [
                        "securitydemos3userdatakey646F9E0C",
                        "Arn"
                      ]
                    },
                    "name": {
                      "Fn::Join": [
                        "",
                        [
                          {
                            "Ref": "guarddutydemouser0B126858"
                          },
                          "-secret-key"
                        ]
                      ]
                    },
                    "secretString": {
                      "Fn::GetAtt": [
                        "compromisedaccesskey16624257",
                        "SecretAccessKey"
                      ]
                    },
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_secretsmanager.CfnSecret",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_secretsmanager.Secret",
              "version": "2.118.0"
            }
          },
          "guardduty_demo_user_policy": {
            "id": "guardduty_demo_user_policy",
            "path": "SecurityFindingGeneratorStack/guardduty_demo_user_policy",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/guardduty_demo_user_policy/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::IAM::Policy",
                  "aws:cdk:cloudformation:props": {
                    "policyDocument": {
                      "Statement": [
                        {
                          "Action": [
                            "s3:PutBucketLogging",
                            "s3:PutBucketPublicAccessBlock"
                          ],
                          "Effect": "Allow",
                          "Resource": {
                            "Fn::GetAtt": [
                              "securityservicedemobucketDB0AACC9",
                              "Arn"
                            ]
                          },
                          "Sid": "EC2Allow"
                        }
                      ],
                      "Version": "2012-10-17"
                    },
                    "policyName": "guardduty_demo_user_policy",
                    "users": [
                      {
                        "Ref": "guarddutydemouser0B126858"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.CfnPolicy",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_iam.Policy",
              "version": "2.118.0"
            }
          },
          "guardduty_demo_user_key": {
            "id": "guardduty_demo_user_key",
            "path": "SecurityFindingGeneratorStack/guardduty_demo_user_key",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/guardduty_demo_user_key/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::IAM::AccessKey",
                  "aws:cdk:cloudformation:props": {
                    "userName": {
                      "Ref": "guarddutydemouser0B126858"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.CfnAccessKey",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_iam.AccessKey",
              "version": "2.118.0"
            }
          },
          "EC2S3ReadOnlyAccess": {
            "id": "EC2S3ReadOnlyAccess",
            "path": "SecurityFindingGeneratorStack/EC2S3ReadOnlyAccess",
            "constructInfo": {
              "fqn": "aws-cdk-lib.Resource",
              "version": "2.118.0"
            }
          },
          "EC2RoleforSSMAccess": {
            "id": "EC2RoleforSSMAccess",
            "path": "SecurityFindingGeneratorStack/EC2RoleforSSMAccess",
            "constructInfo": {
              "fqn": "aws-cdk-lib.Resource",
              "version": "2.118.0"
            }
          },
          "EC2AdminAccess": {
            "id": "EC2AdminAccess",
            "path": "SecurityFindingGeneratorStack/EC2AdminAccess",
            "constructInfo": {
              "fqn": "aws-cdk-lib.Resource",
              "version": "2.118.0"
            }
          },
          "ec2_general_role": {
            "id": "ec2_general_role",
            "path": "SecurityFindingGeneratorStack/ec2_general_role",
            "children": {
              "Importec2_general_role": {
                "id": "Importec2_general_role",
                "path": "SecurityFindingGeneratorStack/ec2_general_role/Importec2_general_role",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.Resource",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/ec2_general_role/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::IAM::Role",
                  "aws:cdk:cloudformation:props": {
                    "assumeRolePolicyDocument": {
                      "Statement": [
                        {
                          "Action": "sts:AssumeRole",
                          "Effect": "Allow",
                          "Principal": {
                            "Service": "ec2.amazonaws.com"
                          }
                        }
                      ],
                      "Version": "2012-10-17"
                    },
                    "managedPolicyArns": [
                      "arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess",
                      "arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore",
                      "arn:aws:iam::aws:policy/AdministratorAccess"
                    ],
                    "roleName": "ec2-general-demo-role",
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.CfnRole",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_iam.Role",
              "version": "2.118.0"
            }
          },
          "ec2_general_managed_policy": {
            "id": "ec2_general_managed_policy",
            "path": "SecurityFindingGeneratorStack/ec2_general_managed_policy",
            "children": {
              "Importedec2_general_managed_policy": {
                "id": "Importedec2_general_managed_policy",
                "path": "SecurityFindingGeneratorStack/ec2_general_managed_policy/Importedec2_general_managed_policy",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.Resource",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/ec2_general_managed_policy/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::IAM::ManagedPolicy",
                  "aws:cdk:cloudformation:props": {
                    "description": "Policy for general EC2 instance profile role.",
                    "managedPolicyName": "ec2-guardduty-general-demo-policy",
                    "path": "/",
                    "policyDocument": {
                      "Statement": [
                        {
                          "Action": [
                            "ssm:DescribeParameters",
                            "ssm:GetParameter",
                            "ssm:PutParameter"
                          ],
                          "Effect": "Allow",
                          "Resource": [
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":ssm:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":parameter",
                                  {
                                    "Ref": "eksclusternameparameterEBFB62AB"
                                  }
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":ssm:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":parameter",
                                  {
                                    "Ref": "securitydemodynamodbparameter0E1E1F46"
                                  }
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":ssm:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":parameter",
                                  {
                                    "Ref": "securitydemos3userdatabucketparameter668DD41E"
                                  }
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":ssm:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":parameter/",
                                  {
                                    "Ref": "dbpwparameter758A619A"
                                  }
                                ]
                              ]
                            }
                          ],
                          "Sid": "SSMWriteAllow"
                        },
                        {
                          "Action": "dynamodb:PutItem",
                          "Effect": "Allow",
                          "Resource": {
                            "Fn::GetAtt": [
                              "securitydemodynamodbB3DD1E6E",
                              "Arn"
                            ]
                          },
                          "Sid": "DynamoDBWriteAllow"
                        },
                        {
                          "Action": [
                            "dynamodb:DescribeTable",
                            "dynamodb:ListTables"
                          ],
                          "Effect": "Allow",
                          "Resource": {
                            "Fn::Join": [
                              "",
                              [
                                "arn:",
                                {
                                  "Ref": "AWS::Partition"
                                },
                                ":dynamodb:",
                                {
                                  "Ref": "AWS::Region"
                                },
                                ":",
                                {
                                  "Ref": "AWS::AccountId"
                                },
                                ":table/*}"
                              ]
                            ]
                          },
                          "Sid": "DynamoDBReadAllow"
                        },
                        {
                          "Action": [
                            "s3:PutBucketLogging",
                            "s3:PutBucketPublicAccessBlock"
                          ],
                          "Effect": "Allow",
                          "Resource": {
                            "Fn::GetAtt": [
                              "securityservicedemobucketDB0AACC9",
                              "Arn"
                            ]
                          },
                          "Sid": "S3DemoWriteAllow"
                        },
                        {
                          "Action": [
                            "s3:GetAccountPublicAccessBlock",
                            "s3:ListBucket",
                            "s3:PutAccountPublicAccessBlock"
                          ],
                          "Effect": "Allow",
                          "Resource": "*",
                          "Sid": "S3WriteAllow"
                        },
                        {
                          "Action": "secretsmanager:GetSecretValue",
                          "Effect": "Allow",
                          "Resource": {
                            "Ref": "compromisedaccesskeysecretF728B00B"
                          },
                          "Sid": "SecretsManagerReadAllow"
                        }
                      ],
                      "Version": "2012-10-17"
                    },
                    "roles": [
                      {
                        "Ref": "ec2generalrole126EB842"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.CfnManagedPolicy",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_iam.ManagedPolicy",
              "version": "2.118.0"
            }
          },
          "compromised_ec2_instance": {
            "id": "compromised_ec2_instance",
            "path": "SecurityFindingGeneratorStack/compromised_ec2_instance",
            "children": {
              "InstanceProfile": {
                "id": "InstanceProfile",
                "path": "SecurityFindingGeneratorStack/compromised_ec2_instance/InstanceProfile",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::IAM::InstanceProfile",
                  "aws:cdk:cloudformation:props": {
                    "roles": [
                      {
                        "Ref": "ec2generalrole126EB842"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.CfnInstanceProfile",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/compromised_ec2_instance/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::EC2::Instance",
                  "aws:cdk:cloudformation:props": {
                    "availabilityZone": {
                      "Fn::Select": [
                        0,
                        {
                          "Fn::GetAZs": ""
                        }
                      ]
                    },
                    "blockDeviceMappings": [
                      {
                        "deviceName": "/dev/xvda",
                        "ebs": {
                          "deleteOnTermination": true,
                          "encrypted": true,
                          "volumeSize": 30,
                          "volumeType": "gp2"
                        }
                      }
                    ],
                    "iamInstanceProfile": {
                      "Ref": "compromisedec2instanceInstanceProfileC4F17054"
                    },
                    "imageId": {
                      "Ref": "SsmParameterValueawsserviceamiamazonlinuxlatestamzn2amihvmx8664gp2C96584B6F00A464EAD1953AFF4B05118Parameter"
                    },
                    "instanceType": "t2.micro",
                    "securityGroupIds": [
                      {
                        "Fn::GetAtt": [
                          "securitydemosg72A385FB",
                          "GroupId"
                        ]
                      }
                    ],
                    "subnetId": {
                      "Ref": "securitydemovpcdemoprivatenatsubnetSubnet1SubnetF2EA78AC"
                    },
                    "tags": [
                      {
                        "key": "Name",
                        "value": "guardduty_compromised_finding_demo"
                      },
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ],
                    "userData": {
                      "Fn::Base64": {
                        "Fn::Join": [
                          "",
                          [
                            "#!/bin/bash\nsleep 60\nsudo aws s3 cp s3://",
                            {
                              "Ref": "securitydemos3userdatabucketC56A23F8"
                            },
                            "/ec2-user-data-demo/guardduty-user-data-credentials.sh /home/ec2-user/\nsudo chmod +x /home/ec2-user/guardduty-user-data-credentials.sh\nsudo /home/ec2-user/guardduty-user-data-credentials.sh"
                          ]
                        ]
                      }
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_ec2.CfnInstance",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_ec2.Instance",
              "version": "2.118.0"
            }
          },
          "compromised_ec2_eip": {
            "id": "compromised_ec2_eip",
            "path": "SecurityFindingGeneratorStack/compromised_ec2_eip",
            "attributes": {
              "aws:cdk:cloudformation:type": "AWS::EC2::EIP",
              "aws:cdk:cloudformation:props": {
                "domain": "vpc",
                "instanceId": {
                  "Ref": "compromisedec2instanceF21EFAAC"
                },
                "tags": [
                  {
                    "key": "security-demo",
                    "value": "true"
                  }
                ]
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_ec2.CfnEIP",
              "version": "2.118.0"
            }
          },
          "lambdaGDThreatListExecutionPolicy": {
            "id": "lambdaGDThreatListExecutionPolicy",
            "path": "SecurityFindingGeneratorStack/lambdaGDThreatListExecutionPolicy",
            "constructInfo": {
              "fqn": "aws-cdk-lib.Resource",
              "version": "2.118.0"
            }
          },
          "lambdaGDThreatListVPCPolicy": {
            "id": "lambdaGDThreatListVPCPolicy",
            "path": "SecurityFindingGeneratorStack/lambdaGDThreatListVPCPolicy",
            "constructInfo": {
              "fqn": "aws-cdk-lib.Resource",
              "version": "2.118.0"
            }
          },
          "lambda_threat_list_role": {
            "id": "lambda_threat_list_role",
            "path": "SecurityFindingGeneratorStack/lambda_threat_list_role",
            "children": {
              "Importlambda_threat_list_role": {
                "id": "Importlambda_threat_list_role",
                "path": "SecurityFindingGeneratorStack/lambda_threat_list_role/Importlambda_threat_list_role",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.Resource",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/lambda_threat_list_role/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::IAM::Role",
                  "aws:cdk:cloudformation:props": {
                    "assumeRolePolicyDocument": {
                      "Statement": [
                        {
                          "Action": "sts:AssumeRole",
                          "Effect": "Allow",
                          "Principal": {
                            "Service": "lambda.amazonaws.com"
                          }
                        }
                      ],
                      "Version": "2012-10-17"
                    },
                    "managedPolicyArns": [
                      "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
                      "arn:aws:iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"
                    ],
                    "roleName": "guardduty-threat-list-lambda-role",
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.CfnRole",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_iam.Role",
              "version": "2.118.0"
            }
          },
          "lambdaGDThreatListManagedPolicy": {
            "id": "lambdaGDThreatListManagedPolicy",
            "path": "SecurityFindingGeneratorStack/lambdaGDThreatListManagedPolicy",
            "children": {
              "ImportedlambdaGDThreatListManagedPolicy": {
                "id": "ImportedlambdaGDThreatListManagedPolicy",
                "path": "SecurityFindingGeneratorStack/lambdaGDThreatListManagedPolicy/ImportedlambdaGDThreatListManagedPolicy",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.Resource",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/lambdaGDThreatListManagedPolicy/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::IAM::ManagedPolicy",
                  "aws:cdk:cloudformation:props": {
                    "description": "Add GuardDuty Threat IP list.",
                    "managedPolicyName": "gd-threat-list-policy",
                    "path": "/",
                    "policyDocument": {
                      "Statement": [
                        {
                          "Action": [
                            "guardduty:CreateThreatIntelSet",
                            "guardduty:GetDetector",
                            "guardduty:GetThreatIntelSet",
                            "guardduty:ListDetectors",
                            "guardduty:ListThreatIntelSets",
                            "guardduty:UpdateDetector",
                            "guardduty:UpdateThreatIntelSet"
                          ],
                          "Effect": "Allow",
                          "Resource": {
                            "Fn::Join": [
                              "",
                              [
                                "arn:",
                                {
                                  "Ref": "AWS::Partition"
                                },
                                ":guardduty:",
                                {
                                  "Ref": "AWS::Region"
                                },
                                ":",
                                {
                                  "Ref": "AWS::AccountId"
                                },
                                ":detector/*"
                              ]
                            ]
                          },
                          "Sid": "GuardDutyAllow"
                        },
                        {
                          "Action": [
                            "iam:DeleteRolePolicy",
                            "iam:PutRolePolicy"
                          ],
                          "Effect": "Allow",
                          "Resource": {
                            "Fn::Join": [
                              "",
                              [
                                "arn:",
                                {
                                  "Ref": "AWS::Partition"
                                },
                                ":iam::",
                                {
                                  "Ref": "AWS::AccountId"
                                },
                                ":role/aws-service-role/guardduty.amazonaws.com/AWSServiceRoleForAmazonGuardDuty"
                              ]
                            ]
                          },
                          "Sid": "IAMAllow"
                        }
                      ],
                      "Version": "2012-10-17"
                    },
                    "roles": [
                      {
                        "Ref": "lambdathreatlistrole03396CF8"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.CfnManagedPolicy",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_iam.ManagedPolicy",
              "version": "2.118.0"
            }
          },
          "guardduty_threat_list_function": {
            "id": "guardduty_threat_list_function",
            "path": "SecurityFindingGeneratorStack/guardduty_threat_list_function",
            "children": {
              "Code": {
                "id": "Code",
                "path": "SecurityFindingGeneratorStack/guardduty_threat_list_function/Code",
                "children": {
                  "Stage": {
                    "id": "Stage",
                    "path": "SecurityFindingGeneratorStack/guardduty_threat_list_function/Code/Stage",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.AssetStaging",
                      "version": "2.118.0"
                    }
                  },
                  "AssetBucket": {
                    "id": "AssetBucket",
                    "path": "SecurityFindingGeneratorStack/guardduty_threat_list_function/Code/AssetBucket",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_s3.BucketBase",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_s3_assets.Asset",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/guardduty_threat_list_function/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::Lambda::Function",
                  "aws:cdk:cloudformation:props": {
                    "code": {
                      "s3Bucket": {
                        "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
                      },
                      "s3Key": "858714e69826a43f927995f26a4ff203d260ab04524cd500a72b58c4cea65975.zip"
                    },
                    "description": "Function to put GuardDuty Threat IP list for demo.",
                    "environment": {
                      "variables": {
                        "BUCKET_NAME": {
                          "Ref": "securitydemos3userdatabucketC56A23F8"
                        },
                        "THREAT_LIST": {
                          "Fn::GetAtt": [
                            "compromisedec2instanceF21EFAAC",
                            "PrivateIp"
                          ]
                        }
                      }
                    },
                    "functionName": "guardduty_threat_list_function",
                    "handler": "threat_list.lambda_handler",
                    "memorySize": 1024,
                    "role": {
                      "Fn::GetAtt": [
                        "lambdathreatlistrole03396CF8",
                        "Arn"
                      ]
                    },
                    "runtime": "python3.9",
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ],
                    "timeout": 120
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_lambda.CfnFunction",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_lambda.Function",
              "version": "2.118.0"
            }
          },
          "guardduty_threat_list_provider": {
            "id": "guardduty_threat_list_provider",
            "path": "SecurityFindingGeneratorStack/guardduty_threat_list_provider",
            "children": {
              "framework-onEvent": {
                "id": "framework-onEvent",
                "path": "SecurityFindingGeneratorStack/guardduty_threat_list_provider/framework-onEvent",
                "children": {
                  "ServiceRole": {
                    "id": "ServiceRole",
                    "path": "SecurityFindingGeneratorStack/guardduty_threat_list_provider/framework-onEvent/ServiceRole",
                    "children": {
                      "ImportServiceRole": {
                        "id": "ImportServiceRole",
                        "path": "SecurityFindingGeneratorStack/guardduty_threat_list_provider/framework-onEvent/ServiceRole/ImportServiceRole",
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.Resource",
                          "version": "2.118.0"
                        }
                      },
                      "Resource": {
                        "id": "Resource",
                        "path": "SecurityFindingGeneratorStack/guardduty_threat_list_provider/framework-onEvent/ServiceRole/Resource",
                        "attributes": {
                          "aws:cdk:cloudformation:type": "AWS::IAM::Role",
                          "aws:cdk:cloudformation:props": {
                            "assumeRolePolicyDocument": {
                              "Statement": [
                                {
                                  "Action": "sts:AssumeRole",
                                  "Effect": "Allow",
                                  "Principal": {
                                    "Service": "lambda.amazonaws.com"
                                  }
                                }
                              ],
                              "Version": "2012-10-17"
                            },
                            "managedPolicyArns": [
                              {
                                "Fn::Join": [
                                  "",
                                  [
                                    "arn:",
                                    {
                                      "Ref": "AWS::Partition"
                                    },
                                    ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
                                  ]
                                ]
                              }
                            ],
                            "tags": [
                              {
                                "key": "security-demo",
                                "value": "true"
                              }
                            ]
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_iam.CfnRole",
                          "version": "2.118.0"
                        }
                      },
                      "DefaultPolicy": {
                        "id": "DefaultPolicy",
                        "path": "SecurityFindingGeneratorStack/guardduty_threat_list_provider/framework-onEvent/ServiceRole/DefaultPolicy",
                        "children": {
                          "Resource": {
                            "id": "Resource",
                            "path": "SecurityFindingGeneratorStack/guardduty_threat_list_provider/framework-onEvent/ServiceRole/DefaultPolicy/Resource",
                            "attributes": {
                              "aws:cdk:cloudformation:type": "AWS::IAM::Policy",
                              "aws:cdk:cloudformation:props": {
                                "policyDocument": {
                                  "Statement": [
                                    {
                                      "Action": "lambda:InvokeFunction",
                                      "Effect": "Allow",
                                      "Resource": [
                                        {
                                          "Fn::GetAtt": [
                                            "guarddutythreatlistfunction69378CD7",
                                            "Arn"
                                          ]
                                        },
                                        {
                                          "Fn::Join": [
                                            "",
                                            [
                                              {
                                                "Fn::GetAtt": [
                                                  "guarddutythreatlistfunction69378CD7",
                                                  "Arn"
                                                ]
                                              },
                                              ":*"
                                            ]
                                          ]
                                        }
                                      ]
                                    }
                                  ],
                                  "Version": "2012-10-17"
                                },
                                "policyName": "guarddutythreatlistproviderframeworkonEventServiceRoleDefaultPolicyF24F1A84",
                                "roles": [
                                  {
                                    "Ref": "guarddutythreatlistproviderframeworkonEventServiceRole17D02AE6"
                                  }
                                ]
                              }
                            },
                            "constructInfo": {
                              "fqn": "aws-cdk-lib.aws_iam.CfnPolicy",
                              "version": "2.118.0"
                            }
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_iam.Policy",
                          "version": "2.118.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_iam.Role",
                      "version": "2.118.0"
                    }
                  },
                  "Code": {
                    "id": "Code",
                    "path": "SecurityFindingGeneratorStack/guardduty_threat_list_provider/framework-onEvent/Code",
                    "children": {
                      "Stage": {
                        "id": "Stage",
                        "path": "SecurityFindingGeneratorStack/guardduty_threat_list_provider/framework-onEvent/Code/Stage",
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.AssetStaging",
                          "version": "2.118.0"
                        }
                      },
                      "AssetBucket": {
                        "id": "AssetBucket",
                        "path": "SecurityFindingGeneratorStack/guardduty_threat_list_provider/framework-onEvent/Code/AssetBucket",
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_s3.BucketBase",
                          "version": "2.118.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_s3_assets.Asset",
                      "version": "2.118.0"
                    }
                  },
                  "Resource": {
                    "id": "Resource",
                    "path": "SecurityFindingGeneratorStack/guardduty_threat_list_provider/framework-onEvent/Resource",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::Lambda::Function",
                      "aws:cdk:cloudformation:props": {
                        "code": {
                          "s3Bucket": {
                            "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
                          },
                          "s3Key": "7382a0addb9f34974a1ea6c6c9b063882af874828f366f5c93b2b7b64db15c94.zip"
                        },
                        "description": "AWS CDK resource provider framework - onEvent (SecurityFindingGeneratorStack/guardduty_threat_list_provider)",
                        "environment": {
                          "variables": {
                            "USER_ON_EVENT_FUNCTION_ARN": {
                              "Fn::GetAtt": [
                                "guarddutythreatlistfunction69378CD7",
                                "Arn"
                              ]
                            }
                          }
                        },
                        "handler": "framework.onEvent",
                        "role": {
                          "Fn::GetAtt": [
                            "guarddutythreatlistproviderframeworkonEventServiceRole17D02AE6",
                            "Arn"
                          ]
                        },
                        "runtime": "nodejs18.x",
                        "tags": [
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ],
                        "timeout": 900
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_lambda.CfnFunction",
                      "version": "2.118.0"
                    }
                  },
                  "LogRetention": {
                    "id": "LogRetention",
                    "path": "SecurityFindingGeneratorStack/guardduty_threat_list_provider/framework-onEvent/LogRetention",
                    "children": {
                      "Resource": {
                        "id": "Resource",
                        "path": "SecurityFindingGeneratorStack/guardduty_threat_list_provider/framework-onEvent/LogRetention/Resource",
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.CfnResource",
                          "version": "2.118.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_logs.LogRetention",
                      "version": "2.118.0"
                    }
                  },
                  "LogGroup": {
                    "id": "LogGroup",
                    "path": "SecurityFindingGeneratorStack/guardduty_threat_list_provider/framework-onEvent/LogGroup",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.Resource",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_lambda.Function",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.custom_resources.Provider",
              "version": "2.118.0"
            }
          },
          "threat_list_custguardduty_threat_list_custom_actionom_action": {
            "id": "threat_list_custguardduty_threat_list_custom_actionom_action",
            "path": "SecurityFindingGeneratorStack/threat_list_custguardduty_threat_list_custom_actionom_action",
            "children": {
              "Default": {
                "id": "Default",
                "path": "SecurityFindingGeneratorStack/threat_list_custguardduty_threat_list_custom_actionom_action/Default",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.CfnResource",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.CustomResource",
              "version": "2.118.0"
            }
          },
          "guardduty_topic": {
            "id": "guardduty_topic",
            "path": "SecurityFindingGeneratorStack/guardduty_topic",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/guardduty_topic/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::SNS::Topic",
                  "aws:cdk:cloudformation:props": {
                    "displayName": "GuardDuty Demo IAM SNS topic",
                    "kmsMasterKeyId": {
                      "Fn::GetAtt": [
                        "securitydemos3userdatakey646F9E0C",
                        "Arn"
                      ]
                    },
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_sns.CfnTopic",
                  "version": "2.118.0"
                }
              },
              "Policy": {
                "id": "Policy",
                "path": "SecurityFindingGeneratorStack/guardduty_topic/Policy",
                "children": {
                  "Resource": {
                    "id": "Resource",
                    "path": "SecurityFindingGeneratorStack/guardduty_topic/Policy/Resource",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::SNS::TopicPolicy",
                      "aws:cdk:cloudformation:props": {
                        "policyDocument": {
                          "Statement": [
                            {
                              "Action": "sns:Publish",
                              "Effect": "Allow",
                              "Principal": {
                                "Service": "events.amazonaws.com"
                              },
                              "Resource": {
                                "Ref": "guarddutytopic4054B514"
                              },
                              "Sid": "0"
                            }
                          ],
                          "Version": "2012-10-17"
                        },
                        "topics": [
                          {
                            "Ref": "guarddutytopic4054B514"
                          }
                        ]
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_sns.CfnTopicPolicy",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_sns.TopicPolicy",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_sns.Topic",
              "version": "2.118.0"
            }
          },
          "lambdaGDIAMRemediationExecutionPolicy": {
            "id": "lambdaGDIAMRemediationExecutionPolicy",
            "path": "SecurityFindingGeneratorStack/lambdaGDIAMRemediationExecutionPolicy",
            "constructInfo": {
              "fqn": "aws-cdk-lib.Resource",
              "version": "2.118.0"
            }
          },
          "guardduty_iam_remediation_role": {
            "id": "guardduty_iam_remediation_role",
            "path": "SecurityFindingGeneratorStack/guardduty_iam_remediation_role",
            "children": {
              "Importguardduty_iam_remediation_role": {
                "id": "Importguardduty_iam_remediation_role",
                "path": "SecurityFindingGeneratorStack/guardduty_iam_remediation_role/Importguardduty_iam_remediation_role",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.Resource",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/guardduty_iam_remediation_role/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::IAM::Role",
                  "aws:cdk:cloudformation:props": {
                    "assumeRolePolicyDocument": {
                      "Statement": [
                        {
                          "Action": "sts:AssumeRole",
                          "Effect": "Allow",
                          "Principal": {
                            "Service": "lambda.amazonaws.com"
                          }
                        }
                      ],
                      "Version": "2012-10-17"
                    },
                    "managedPolicyArns": [
                      "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
                    ],
                    "roleName": "guardduty-demo-iam-remediation-role",
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.CfnRole",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_iam.Role",
              "version": "2.118.0"
            }
          },
          "lambdaGDIAMRemediationManagedPolicy": {
            "id": "lambdaGDIAMRemediationManagedPolicy",
            "path": "SecurityFindingGeneratorStack/lambdaGDIAMRemediationManagedPolicy",
            "children": {
              "ImportedlambdaGDIAMRemediationManagedPolicy": {
                "id": "ImportedlambdaGDIAMRemediationManagedPolicy",
                "path": "SecurityFindingGeneratorStack/lambdaGDIAMRemediationManagedPolicy/ImportedlambdaGDIAMRemediationManagedPolicy",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.Resource",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/lambdaGDIAMRemediationManagedPolicy/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::IAM::ManagedPolicy",
                  "aws:cdk:cloudformation:props": {
                    "description": "Remediate GuardDuty IAM findings from the demo.",
                    "managedPolicyName": "gd-iam-remediation-policy",
                    "path": "/",
                    "policyDocument": {
                      "Statement": [
                        {
                          "Action": [
                            "ssm:DescribeParameters",
                            "ssm:GetParameter",
                            "ssm:GetParameters"
                          ],
                          "Effect": "Allow",
                          "Resource": {
                            "Fn::Join": [
                              "",
                              [
                                "arn:",
                                {
                                  "Ref": "AWS::Partition"
                                },
                                ":ssm:",
                                {
                                  "Ref": "AWS::Region"
                                },
                                ":",
                                {
                                  "Ref": "AWS::AccountId"
                                },
                                ":parameter/*"
                              ]
                            ]
                          },
                          "Sid": "SSMAccess"
                        },
                        {
                          "Action": "iam:PassRole",
                          "Effect": "Allow",
                          "Resource": {
                            "Fn::GetAtt": [
                              "ec2instancemodulerole43B94AC9",
                              "Arn"
                            ]
                          },
                          "Sid": "IAMPassRole"
                        },
                        {
                          "Action": [
                            "ec2:DescribeIamInstanceProfileAssociations",
                            "ec2:ReplaceIamInstanceProfileAssociation"
                          ],
                          "Effect": "Allow",
                          "Resource": {
                            "Fn::Join": [
                              "",
                              [
                                "arn:",
                                {
                                  "Ref": "AWS::Partition"
                                },
                                ":ec2:",
                                {
                                  "Ref": "AWS::Region"
                                },
                                ":",
                                {
                                  "Ref": "AWS::AccountId"
                                },
                                ":instance/*"
                              ]
                            ]
                          },
                          "Sid": "EC2Allow"
                        },
                        {
                          "Action": [
                            "iam:AddRoleToInstanceProfile",
                            "iam:CreateInstanceProfile",
                            "iam:ListInstanceProfilesForRole",
                            "iam:RemoveRoleFromInstanceProfile"
                          ],
                          "Effect": "Allow",
                          "Resource": {
                            "Fn::Join": [
                              "",
                              [
                                "arn:",
                                {
                                  "Ref": "AWS::Partition"
                                },
                                ":iam::",
                                {
                                  "Ref": "AWS::AccountId"
                                },
                                ":instance-profile/*"
                              ]
                            ]
                          },
                          "Sid": "IAMAllow"
                        },
                        {
                          "Action": [
                            "iam:DeleteInstanceProfile",
                            "iam:PassRole",
                            "iam:PutRolePolicy"
                          ],
                          "Effect": "Allow",
                          "Resource": [
                            {
                              "Fn::GetAtt": [
                                "ec2generalrole126EB842",
                                "Arn"
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":iam::",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":role/eksctl-GuardDuty-Finding-Demo-addon-iamservi-Role1-*"
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":iam::",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":role/eksctl-GuardDuty-Finding-Demo-nod-NodeInstanceRole-*"
                                ]
                              ]
                            }
                          ],
                          "Sid": "CompromisedEC2Remediation"
                        },
                        {
                          "Action": "sns:Publish",
                          "Effect": "Allow",
                          "Resource": {
                            "Ref": "guarddutytopic4054B514"
                          },
                          "Sid": "SNSAllow"
                        }
                      ],
                      "Version": "2012-10-17"
                    },
                    "roles": [
                      {
                        "Ref": "guarddutyiamremediationrole72463300"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.CfnManagedPolicy",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_iam.ManagedPolicy",
              "version": "2.118.0"
            }
          },
          "guardduty_iam_remediation_function": {
            "id": "guardduty_iam_remediation_function",
            "path": "SecurityFindingGeneratorStack/guardduty_iam_remediation_function",
            "children": {
              "Code": {
                "id": "Code",
                "path": "SecurityFindingGeneratorStack/guardduty_iam_remediation_function/Code",
                "children": {
                  "Stage": {
                    "id": "Stage",
                    "path": "SecurityFindingGeneratorStack/guardduty_iam_remediation_function/Code/Stage",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.AssetStaging",
                      "version": "2.118.0"
                    }
                  },
                  "AssetBucket": {
                    "id": "AssetBucket",
                    "path": "SecurityFindingGeneratorStack/guardduty_iam_remediation_function/Code/AssetBucket",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_s3.BucketBase",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_s3_assets.Asset",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/guardduty_iam_remediation_function/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::Lambda::Function",
                  "aws:cdk:cloudformation:props": {
                    "code": {
                      "s3Bucket": {
                        "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
                      },
                      "s3Key": "a2789221f81032c966c8c215ab08d192c18dc8815ea73a73f00d8a29d28851f9.zip"
                    },
                    "description": "Function to remediate GuardDuty Instance Credential Exfil findings.",
                    "environment": {
                      "variables": {
                        "TOPIC_ARN": {
                          "Ref": "guarddutytopic4054B514"
                        }
                      }
                    },
                    "functionName": "guardduty_iam_remediation_function",
                    "handler": "gd_remediate_iam.lambda_handler",
                    "memorySize": 1024,
                    "role": {
                      "Fn::GetAtt": [
                        "guarddutyiamremediationrole72463300",
                        "Arn"
                      ]
                    },
                    "runtime": "python3.9",
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ],
                    "timeout": 300
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_lambda.CfnFunction",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_lambda.Function",
              "version": "2.118.0"
            }
          },
          "lambdaEKSCleanupExecutionPolicy": {
            "id": "lambdaEKSCleanupExecutionPolicy",
            "path": "SecurityFindingGeneratorStack/lambdaEKSCleanupExecutionPolicy",
            "constructInfo": {
              "fqn": "aws-cdk-lib.Resource",
              "version": "2.118.0"
            }
          },
          "lambdaEKSCleanupVPCPolicy": {
            "id": "lambdaEKSCleanupVPCPolicy",
            "path": "SecurityFindingGeneratorStack/lambdaEKSCleanupVPCPolicy",
            "constructInfo": {
              "fqn": "aws-cdk-lib.Resource",
              "version": "2.118.0"
            }
          },
          "lambda_eks_cleanup_role": {
            "id": "lambda_eks_cleanup_role",
            "path": "SecurityFindingGeneratorStack/lambda_eks_cleanup_role",
            "children": {
              "Importlambda_eks_cleanup_role": {
                "id": "Importlambda_eks_cleanup_role",
                "path": "SecurityFindingGeneratorStack/lambda_eks_cleanup_role/Importlambda_eks_cleanup_role",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.Resource",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/lambda_eks_cleanup_role/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::IAM::Role",
                  "aws:cdk:cloudformation:props": {
                    "assumeRolePolicyDocument": {
                      "Statement": [
                        {
                          "Action": "sts:AssumeRole",
                          "Effect": "Allow",
                          "Principal": {
                            "Service": "lambda.amazonaws.com"
                          }
                        }
                      ],
                      "Version": "2012-10-17"
                    },
                    "managedPolicyArns": [
                      "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole",
                      "arn:aws:iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"
                    ],
                    "roleName": "eks-lambda-cleanup-role",
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.CfnRole",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_iam.Role",
              "version": "2.118.0"
            }
          },
          "lambdaEKSCleanupManagedPolicy": {
            "id": "lambdaEKSCleanupManagedPolicy",
            "path": "SecurityFindingGeneratorStack/lambdaEKSCleanupManagedPolicy",
            "children": {
              "ImportedlambdaEKSCleanupManagedPolicy": {
                "id": "ImportedlambdaEKSCleanupManagedPolicy",
                "path": "SecurityFindingGeneratorStack/lambdaEKSCleanupManagedPolicy/ImportedlambdaEKSCleanupManagedPolicy",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.Resource",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/lambdaEKSCleanupManagedPolicy/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::IAM::ManagedPolicy",
                  "aws:cdk:cloudformation:props": {
                    "description": "Cleanup deployed EKS CloudFormation template resources from GuardDuty demo.",
                    "managedPolicyName": "eks-cleanup-policy",
                    "path": "/",
                    "policyDocument": {
                      "Statement": [
                        {
                          "Action": "elasticloadbalancing:Describe*",
                          "Effect": "Allow",
                          "Resource": "*",
                          "Sid": "ELBRead"
                        },
                        {
                          "Action": "elasticloadbalancing:DeleteLoadBalancer",
                          "Effect": "Allow",
                          "Resource": {
                            "Fn::Join": [
                              "",
                              [
                                "arn:",
                                {
                                  "Ref": "AWS::Partition"
                                },
                                ":elasticloadbalancing:",
                                {
                                  "Ref": "AWS::Region"
                                },
                                ":",
                                {
                                  "Ref": "AWS::AccountId"
                                },
                                ":loadbalancer/*"
                              ]
                            ]
                          },
                          "Sid": "ELBWrite"
                        },
                        {
                          "Action": "sns:Publish",
                          "Effect": "Allow",
                          "Resource": {
                            "Ref": "guarddutytopic4054B514"
                          },
                          "Sid": "SNSWrite"
                        },
                        {
                          "Action": [
                            "cloudformation:Describe*",
                            "cloudformation:ListStacks"
                          ],
                          "Effect": "Allow",
                          "Resource": "*",
                          "Sid": "CFNRead"
                        },
                        {
                          "Action": "cloudformation:DeleteStack",
                          "Effect": "Allow",
                          "Resource": [
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":cloudformation:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":stack/eksctl-GuardDuty-Finding-Demo-addon-iamserviceaccount-kube-system-aws-node/*"
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":cloudformation:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":stack/eksctl-GuardDuty-Finding-Demo-cluster/*"
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":cloudformation:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":stack/eksctl-GuardDuty-Finding-Demo-nodegroup-ng-*/*"
                                ]
                              ]
                            }
                          ],
                          "Sid": "CFNDelete"
                        },
                        {
                          "Action": [
                            "ec2:DeleteLaunchTemplate",
                            "ec2:DeleteNatGateway",
                            "ec2:DeleteRoute",
                            "ec2:DeleteRouteTable",
                            "ec2:DeleteSecurityGroup",
                            "ec2:DeleteSubnet",
                            "ec2:Describe*",
                            "ec2:DetachInternetGateway",
                            "ec2:RevokeSecurityGroupIngress"
                          ],
                          "Effect": "Allow",
                          "Resource": [
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":ec2:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":internet-gateway/*"
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":ec2:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":launch-template/*"
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":ec2:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":natgateway/*"
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":ec2:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":route-table/*"
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":ec2:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":security-group/*"
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":ec2:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":subnet/*"
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":ec2:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":vpc/*"
                                ]
                              ]
                            }
                          ],
                          "Sid": "EC2Write"
                        },
                        {
                          "Action": "ec2:DisassociateRouteTable",
                          "Effect": "Allow",
                          "Resource": {
                            "Fn::Join": [
                              "",
                              [
                                "arn:",
                                {
                                  "Ref": "AWS::Partition"
                                },
                                ":ec2:",
                                {
                                  "Ref": "AWS::Region"
                                },
                                ":",
                                {
                                  "Ref": "AWS::AccountId"
                                },
                                ":*"
                              ]
                            ]
                          },
                          "Sid": "EC2DisassociateRouteTable"
                        },
                        {
                          "Action": [
                            "eks:DeleteCluster",
                            "eks:DeleteNodegroup",
                            "eks:Describe*"
                          ],
                          "Effect": "Allow",
                          "Resource": [
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":eks:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":cluster/GuardDuty-Finding-Demo"
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":eks:",
                                  {
                                    "Ref": "AWS::Region"
                                  },
                                  ":",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":nodegroup/GuardDuty-Finding-Demo/*"
                                ]
                              ]
                            }
                          ],
                          "Sid": "EKSRead"
                        },
                        {
                          "Action": [
                            "iam:DeleteRole",
                            "iam:DeleteRolePolicy",
                            "iam:DetachRolePolicy"
                          ],
                          "Effect": "Allow",
                          "Resource": [
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":iam::",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":role/eksctl-GuardDuty-Finding-Demo-addon-iamservi-Role1-*"
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":iam::",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":role/eksctl-GuardDuty-Finding-Demo-cluster-ServiceRole-*"
                                ]
                              ]
                            },
                            {
                              "Fn::Join": [
                                "",
                                [
                                  "arn:",
                                  {
                                    "Ref": "AWS::Partition"
                                  },
                                  ":iam::",
                                  {
                                    "Ref": "AWS::AccountId"
                                  },
                                  ":role/eksctl-GuardDuty-Finding-Demo-nod-NodeInstanceRole-*"
                                ]
                              ]
                            }
                          ],
                          "Sid": "IAMWrite"
                        }
                      ],
                      "Version": "2012-10-17"
                    },
                    "roles": [
                      {
                        "Ref": "lambdaekscleanuproleB9A435D9"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_iam.CfnManagedPolicy",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_iam.ManagedPolicy",
              "version": "2.118.0"
            }
          },
          "eks_cleanup_function": {
            "id": "eks_cleanup_function",
            "path": "SecurityFindingGeneratorStack/eks_cleanup_function",
            "children": {
              "Code": {
                "id": "Code",
                "path": "SecurityFindingGeneratorStack/eks_cleanup_function/Code",
                "children": {
                  "Stage": {
                    "id": "Stage",
                    "path": "SecurityFindingGeneratorStack/eks_cleanup_function/Code/Stage",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.AssetStaging",
                      "version": "2.118.0"
                    }
                  },
                  "AssetBucket": {
                    "id": "AssetBucket",
                    "path": "SecurityFindingGeneratorStack/eks_cleanup_function/Code/AssetBucket",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_s3.BucketBase",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_s3_assets.Asset",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/eks_cleanup_function/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::Lambda::Function",
                  "aws:cdk:cloudformation:props": {
                    "code": {
                      "s3Bucket": {
                        "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
                      },
                      "s3Key": "f4bf073144d5b0e92f4ab005be10eb1472f51a41bb6c6132eb5e8a6d8d616bb6.zip"
                    },
                    "description": "Function to clean up EKS CloudFormation template resources built from GuardDuty demo.",
                    "handler": "eks_cleanup.lambda_handler",
                    "memorySize": 1024,
                    "role": {
                      "Fn::GetAtt": [
                        "lambdaekscleanuproleB9A435D9",
                        "Arn"
                      ]
                    },
                    "runtime": "python3.9",
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ],
                    "timeout": 900
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_lambda.CfnFunction",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_lambda.Function",
              "version": "2.118.0"
            }
          },
          "eks_provider": {
            "id": "eks_provider",
            "path": "SecurityFindingGeneratorStack/eks_provider",
            "children": {
              "framework-onEvent": {
                "id": "framework-onEvent",
                "path": "SecurityFindingGeneratorStack/eks_provider/framework-onEvent",
                "children": {
                  "ServiceRole": {
                    "id": "ServiceRole",
                    "path": "SecurityFindingGeneratorStack/eks_provider/framework-onEvent/ServiceRole",
                    "children": {
                      "ImportServiceRole": {
                        "id": "ImportServiceRole",
                        "path": "SecurityFindingGeneratorStack/eks_provider/framework-onEvent/ServiceRole/ImportServiceRole",
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.Resource",
                          "version": "2.118.0"
                        }
                      },
                      "Resource": {
                        "id": "Resource",
                        "path": "SecurityFindingGeneratorStack/eks_provider/framework-onEvent/ServiceRole/Resource",
                        "attributes": {
                          "aws:cdk:cloudformation:type": "AWS::IAM::Role",
                          "aws:cdk:cloudformation:props": {
                            "assumeRolePolicyDocument": {
                              "Statement": [
                                {
                                  "Action": "sts:AssumeRole",
                                  "Effect": "Allow",
                                  "Principal": {
                                    "Service": "lambda.amazonaws.com"
                                  }
                                }
                              ],
                              "Version": "2012-10-17"
                            },
                            "managedPolicyArns": [
                              {
                                "Fn::Join": [
                                  "",
                                  [
                                    "arn:",
                                    {
                                      "Ref": "AWS::Partition"
                                    },
                                    ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
                                  ]
                                ]
                              }
                            ],
                            "tags": [
                              {
                                "key": "security-demo",
                                "value": "true"
                              }
                            ]
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_iam.CfnRole",
                          "version": "2.118.0"
                        }
                      },
                      "DefaultPolicy": {
                        "id": "DefaultPolicy",
                        "path": "SecurityFindingGeneratorStack/eks_provider/framework-onEvent/ServiceRole/DefaultPolicy",
                        "children": {
                          "Resource": {
                            "id": "Resource",
                            "path": "SecurityFindingGeneratorStack/eks_provider/framework-onEvent/ServiceRole/DefaultPolicy/Resource",
                            "attributes": {
                              "aws:cdk:cloudformation:type": "AWS::IAM::Policy",
                              "aws:cdk:cloudformation:props": {
                                "policyDocument": {
                                  "Statement": [
                                    {
                                      "Action": "lambda:InvokeFunction",
                                      "Effect": "Allow",
                                      "Resource": [
                                        {
                                          "Fn::GetAtt": [
                                            "ekscleanupfunctionA5DAE504",
                                            "Arn"
                                          ]
                                        },
                                        {
                                          "Fn::Join": [
                                            "",
                                            [
                                              {
                                                "Fn::GetAtt": [
                                                  "ekscleanupfunctionA5DAE504",
                                                  "Arn"
                                                ]
                                              },
                                              ":*"
                                            ]
                                          ]
                                        }
                                      ]
                                    }
                                  ],
                                  "Version": "2012-10-17"
                                },
                                "policyName": "eksproviderframeworkonEventServiceRoleDefaultPolicy775F29AB",
                                "roles": [
                                  {
                                    "Ref": "eksproviderframeworkonEventServiceRole84214663"
                                  }
                                ]
                              }
                            },
                            "constructInfo": {
                              "fqn": "aws-cdk-lib.aws_iam.CfnPolicy",
                              "version": "2.118.0"
                            }
                          }
                        },
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_iam.Policy",
                          "version": "2.118.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_iam.Role",
                      "version": "2.118.0"
                    }
                  },
                  "Code": {
                    "id": "Code",
                    "path": "SecurityFindingGeneratorStack/eks_provider/framework-onEvent/Code",
                    "children": {
                      "Stage": {
                        "id": "Stage",
                        "path": "SecurityFindingGeneratorStack/eks_provider/framework-onEvent/Code/Stage",
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.AssetStaging",
                          "version": "2.118.0"
                        }
                      },
                      "AssetBucket": {
                        "id": "AssetBucket",
                        "path": "SecurityFindingGeneratorStack/eks_provider/framework-onEvent/Code/AssetBucket",
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.aws_s3.BucketBase",
                          "version": "2.118.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_s3_assets.Asset",
                      "version": "2.118.0"
                    }
                  },
                  "Resource": {
                    "id": "Resource",
                    "path": "SecurityFindingGeneratorStack/eks_provider/framework-onEvent/Resource",
                    "attributes": {
                      "aws:cdk:cloudformation:type": "AWS::Lambda::Function",
                      "aws:cdk:cloudformation:props": {
                        "code": {
                          "s3Bucket": {
                            "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
                          },
                          "s3Key": "7382a0addb9f34974a1ea6c6c9b063882af874828f366f5c93b2b7b64db15c94.zip"
                        },
                        "description": "AWS CDK resource provider framework - onEvent (SecurityFindingGeneratorStack/eks_provider)",
                        "environment": {
                          "variables": {
                            "USER_ON_EVENT_FUNCTION_ARN": {
                              "Fn::GetAtt": [
                                "ekscleanupfunctionA5DAE504",
                                "Arn"
                              ]
                            }
                          }
                        },
                        "handler": "framework.onEvent",
                        "role": {
                          "Fn::GetAtt": [
                            "eksproviderframeworkonEventServiceRole84214663",
                            "Arn"
                          ]
                        },
                        "runtime": "nodejs18.x",
                        "tags": [
                          {
                            "key": "security-demo",
                            "value": "true"
                          }
                        ],
                        "timeout": 900
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_lambda.CfnFunction",
                      "version": "2.118.0"
                    }
                  },
                  "LogRetention": {
                    "id": "LogRetention",
                    "path": "SecurityFindingGeneratorStack/eks_provider/framework-onEvent/LogRetention",
                    "children": {
                      "Resource": {
                        "id": "Resource",
                        "path": "SecurityFindingGeneratorStack/eks_provider/framework-onEvent/LogRetention/Resource",
                        "constructInfo": {
                          "fqn": "aws-cdk-lib.CfnResource",
                          "version": "2.118.0"
                        }
                      }
                    },
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_logs.LogRetention",
                      "version": "2.118.0"
                    }
                  },
                  "LogGroup": {
                    "id": "LogGroup",
                    "path": "SecurityFindingGeneratorStack/eks_provider/framework-onEvent/LogGroup",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.Resource",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_lambda.Function",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.custom_resources.Provider",
              "version": "2.118.0"
            }
          },
          "eks_cleanup_custom_action": {
            "id": "eks_cleanup_custom_action",
            "path": "SecurityFindingGeneratorStack/eks_cleanup_custom_action",
            "children": {
              "Default": {
                "id": "Default",
                "path": "SecurityFindingGeneratorStack/eks_cleanup_custom_action/Default",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.CfnResource",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.CustomResource",
              "version": "2.118.0"
            }
          },
          "guardduty_eks_remediation_function": {
            "id": "guardduty_eks_remediation_function",
            "path": "SecurityFindingGeneratorStack/guardduty_eks_remediation_function",
            "children": {
              "Code": {
                "id": "Code",
                "path": "SecurityFindingGeneratorStack/guardduty_eks_remediation_function/Code",
                "children": {
                  "Stage": {
                    "id": "Stage",
                    "path": "SecurityFindingGeneratorStack/guardduty_eks_remediation_function/Code/Stage",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.AssetStaging",
                      "version": "2.118.0"
                    }
                  },
                  "AssetBucket": {
                    "id": "AssetBucket",
                    "path": "SecurityFindingGeneratorStack/guardduty_eks_remediation_function/Code/AssetBucket",
                    "constructInfo": {
                      "fqn": "aws-cdk-lib.aws_s3.BucketBase",
                      "version": "2.118.0"
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_s3_assets.Asset",
                  "version": "2.118.0"
                }
              },
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/guardduty_eks_remediation_function/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::Lambda::Function",
                  "aws:cdk:cloudformation:props": {
                    "code": {
                      "s3Bucket": {
                        "Fn::Sub": "cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"
                      },
                      "s3Key": "a2789221f81032c966c8c215ab08d192c18dc8815ea73a73f00d8a29d28851f9.zip"
                    },
                    "description": "Function to remediate EKS GuardDuty findings.",
                    "environment": {
                      "variables": {
                        "TOPIC_ARN": {
                          "Ref": "guarddutytopic4054B514"
                        }
                      }
                    },
                    "functionName": "guardduty_demo_eks_remediation_function",
                    "handler": "gd_remediate_eks.lambda_handler",
                    "memorySize": 1024,
                    "role": {
                      "Fn::GetAtt": [
                        "lambdaekscleanuproleB9A435D9",
                        "Arn"
                      ]
                    },
                    "runtime": "python3.9",
                    "tags": [
                      {
                        "key": "security-demo",
                        "value": "true"
                      }
                    ],
                    "timeout": 900
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_lambda.CfnFunction",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_lambda.Function",
              "version": "2.118.0"
            }
          },
          "guardduty_remediation_eks_rule": {
            "id": "guardduty_remediation_eks_rule",
            "path": "SecurityFindingGeneratorStack/guardduty_remediation_eks_rule",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/guardduty_remediation_eks_rule/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::Events::Rule",
                  "aws:cdk:cloudformation:props": {
                    "description": "EventBridge Rule to notify and respond to GuardDuty Event: PrivilegeEscalation:Kubernetes/PrivilegedContainer findings.",
                    "eventPattern": {
                      "source": [
                        "aws.guardduty"
                      ],
                      "detail": {
                        "type": [
                          "PrivilegeEscalation:Kubernetes/PrivilegedContainer",
                          "Execution:Kubernetes/ExecInKubeSystemPod"
                        ]
                      }
                    },
                    "name": "GuardDuty-Event-EKS-Cleanup",
                    "state": "ENABLED",
                    "targets": [
                      {
                        "id": "Target0",
                        "arn": {
                          "Fn::GetAtt": [
                            "guarddutyeksremediationfunctionC5E0C831",
                            "Arn"
                          ]
                        }
                      },
                      {
                        "id": "Target1",
                        "arn": {
                          "Ref": "guarddutytopic4054B514"
                        },
                        "input": "{\"inputPathsMap\":{\"cluster\":\"$.detail.resource.EksClusterDetails.Name\",\"gdid\":\"$.detail.id\",\"region\":\"$.detail.region\"},\"inputTemplate\":\"\\\"GuardDuty Finding | ID:<gdid>: An EKS Cluster named <cluster> may be compromised and should be investigated. Go to https://console.aws.amazon.com/guardduty/home?region=<region>#/findings?macros=current&fId=<gdid>\\\"\"}"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_events.CfnRule",
                  "version": "2.118.0"
                }
              },
              "AllowEventRuleSecurityFindingGeneratorStackguarddutyeksremediationfunctionA12C8F75": {
                "id": "AllowEventRuleSecurityFindingGeneratorStackguarddutyeksremediationfunctionA12C8F75",
                "path": "SecurityFindingGeneratorStack/guardduty_remediation_eks_rule/AllowEventRuleSecurityFindingGeneratorStackguarddutyeksremediationfunctionA12C8F75",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::Lambda::Permission",
                  "aws:cdk:cloudformation:props": {
                    "action": "lambda:InvokeFunction",
                    "functionName": {
                      "Fn::GetAtt": [
                        "guarddutyeksremediationfunctionC5E0C831",
                        "Arn"
                      ]
                    },
                    "principal": "events.amazonaws.com",
                    "sourceArn": {
                      "Fn::GetAtt": [
                        "guarddutyremediationeksrule92B11FBD",
                        "Arn"
                      ]
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_lambda.CfnPermission",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_events.Rule",
              "version": "2.118.0"
            }
          },
          "guardduty_remediation_credexfil_rule": {
            "id": "guardduty_remediation_credexfil_rule",
            "path": "SecurityFindingGeneratorStack/guardduty_remediation_credexfil_rule",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/guardduty_remediation_credexfil_rule/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::Events::Rule",
                  "aws:cdk:cloudformation:props": {
                    "description": "EventBridge Rule to notify and respond to GuardDuty Event: UnauthorizedAccess:IAMUser/InstanceCredentialExfiltration.OutsideAWS findings.",
                    "eventPattern": {
                      "source": [
                        "aws.guardduty"
                      ],
                      "detail": {
                        "type": [
                          "UnauthorizedAccess:IAMUser/InstanceCredentialExfiltration.OutsideAWS"
                        ]
                      }
                    },
                    "name": "GuardDuty-Event-IAMUser-InstanceCredentialExfiltration",
                    "state": "ENABLED",
                    "targets": [
                      {
                        "id": "Target0",
                        "arn": {
                          "Fn::GetAtt": [
                            "guarddutyiamremediationfunction19200E5D",
                            "Arn"
                          ]
                        }
                      },
                      {
                        "id": "Target1",
                        "arn": {
                          "Ref": "guarddutytopic4054B514"
                        },
                        "input": "{\"inputPathsMap\":{\"userName\":\"$.detail.resource.accessKeyDetails.userName\",\"gdid\":\"$.detail.id\",\"region\":\"$.detail.region\"},\"inputTemplate\":\"\\\"GuardDuty Finding | ID:<gdid>: An EC2 instance IAM credentials (Role: <userName>) may be compromised and should be investigated. Go to https://console.aws.amazon.com/guardduty/home?region=<region>#/findings?macros=current&fId=<gdid>\\\"\"}"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_events.CfnRule",
                  "version": "2.118.0"
                }
              },
              "AllowEventRuleSecurityFindingGeneratorStackguarddutyiamremediationfunction3107FC15": {
                "id": "AllowEventRuleSecurityFindingGeneratorStackguarddutyiamremediationfunction3107FC15",
                "path": "SecurityFindingGeneratorStack/guardduty_remediation_credexfil_rule/AllowEventRuleSecurityFindingGeneratorStackguarddutyiamremediationfunction3107FC15",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::Lambda::Permission",
                  "aws:cdk:cloudformation:props": {
                    "action": "lambda:InvokeFunction",
                    "functionName": {
                      "Fn::GetAtt": [
                        "guarddutyiamremediationfunction19200E5D",
                        "Arn"
                      ]
                    },
                    "principal": "events.amazonaws.com",
                    "sourceArn": {
                      "Fn::GetAtt": [
                        "guarddutyremediationcredexfilrule1771230D",
                        "Arn"
                      ]
                    }
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_lambda.CfnPermission",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_events.Rule",
              "version": "2.118.0"
            }
          },
          "guardduty_respond_IAMUser_rule": {
            "id": "guardduty_respond_IAMUser_rule",
            "path": "SecurityFindingGeneratorStack/guardduty_respond_IAMUser_rule",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/guardduty_respond_IAMUser_rule/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::Events::Rule",
                  "aws:cdk:cloudformation:props": {
                    "description": "EventBridge Rule to notify for GuardDuty Event: UnauthorizedAccess:IAMUser/MaliciousIPCaller.Custom findings.",
                    "eventPattern": {
                      "source": [
                        "aws.guardduty"
                      ],
                      "detail": {
                        "type": [
                          "UnauthorizedAccess:IAMUser/MaliciousIPCaller.Custom",
                          "Discovery:S3/MaliciousIPCaller.Custom"
                        ]
                      }
                    },
                    "name": "GuardDuty-Event-IAMUser-MaliciousIPCaller",
                    "state": "ENABLED",
                    "targets": [
                      {
                        "id": "Target0",
                        "arn": {
                          "Ref": "guarddutytopic4054B514"
                        },
                        "input": "{\"inputPathsMap\":{\"userName\":\"$.detail.resource.accessKeyDetails.userName\",\"gdid\":\"$.detail.id\",\"region\":\"$.detail.region\"},\"inputTemplate\":\"\\\"GuardDuty Finding | ID:<gdid>: An AWS API operation was invoked (userName: <userName>) from an IP address that is included on your threat list and should be investigated. Go to https://console.aws.amazon.com/guardduty/home?region=<region>#/findings?macros=current&fId=<gdid>\\\"\"}"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_events.CfnRule",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_events.Rule",
              "version": "2.118.0"
            }
          },
          "guardduty_respond_S3_rule": {
            "id": "guardduty_respond_S3_rule",
            "path": "SecurityFindingGeneratorStack/guardduty_respond_S3_rule",
            "children": {
              "Resource": {
                "id": "Resource",
                "path": "SecurityFindingGeneratorStack/guardduty_respond_S3_rule/Resource",
                "attributes": {
                  "aws:cdk:cloudformation:type": "AWS::Events::Rule",
                  "aws:cdk:cloudformation:props": {
                    "description": "EventBridge Rule to notify for GuardDuty Event: Stealth:S3/ServerAccessLoggingDisabled & Policy:S3/BucketBlockPublicAccessDisabled.",
                    "eventPattern": {
                      "source": [
                        "aws.guardduty"
                      ],
                      "detail": {
                        "type": [
                          "Policy:S3/BucketBlockPublicAccessDisabled",
                          "Stealth:S3/ServerAccessLoggingDisabled"
                        ]
                      }
                    },
                    "name": "GuardDuty-Event-S3-Stealth-Policy",
                    "state": "ENABLED",
                    "targets": [
                      {
                        "id": "Target0",
                        "arn": {
                          "Ref": "guarddutytopic4054B514"
                        },
                        "input": "{\"inputPathsMap\":{\"userName\":\"$.detail.resource.accessKeyDetails.userName\",\"gdid\":\"$.detail.id\",\"region\":\"$.detail.region\"},\"inputTemplate\":\"\\\"GuardDuty Finding | ID:<gdid>: An AWS S3 related API operation was invoked by user (userName: <userName>) in account <account> . This activity seems suspicious. Please investigate with the user to check if this was expectated behaviour. Go to https://console.aws.amazon.com/guardduty/home?region=<region>#/findings?macros=current&fId=<gdid>\\\"\"}"
                      }
                    ]
                  }
                },
                "constructInfo": {
                  "fqn": "aws-cdk-lib.aws_events.CfnRule",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_events.Rule",
              "version": "2.118.0"
            }
          },
          "gd_iam_subscription": {
            "id": "gd_iam_subscription",
            "path": "SecurityFindingGeneratorStack/gd_iam_subscription",
            "attributes": {
              "aws:cdk:cloudformation:type": "AWS::SNS::Subscription",
              "aws:cdk:cloudformation:props": {
                "endpoint": {
                  "Fn::GetAtt": [
                    "guarddutyiamremediationfunction19200E5D",
                    "Arn"
                  ]
                },
                "protocol": "lambda",
                "topicArn": {
                  "Ref": "guarddutytopic4054B514"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_sns.CfnSubscription",
              "version": "2.118.0"
            }
          },
          "gd_eks_subscription": {
            "id": "gd_eks_subscription",
            "path": "SecurityFindingGeneratorStack/gd_eks_subscription",
            "attributes": {
              "aws:cdk:cloudformation:type": "AWS::SNS::Subscription",
              "aws:cdk:cloudformation:props": {
                "endpoint": {
                  "Fn::GetAtt": [
                    "guarddutyeksremediationfunctionC5E0C831",
                    "Arn"
                  ]
                },
                "protocol": "lambda",
                "topicArn": {
                  "Ref": "guarddutytopic4054B514"
                }
              }
            },
            "constructInfo": {
              "fqn": "aws-cdk-lib.aws_sns.CfnSubscription",
              "version": "2.118.0"
            }
          },
          "CDKMetadata": {
            "id": "CDKMetadata",
            "path": "SecurityFindingGeneratorStack/CDKMetadata",
            "children": {
              "Default": {
                "id": "Default",
                "path": "SecurityFindingGeneratorStack/CDKMetadata/Default",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.CfnResource",
                  "version": "2.118.0"
                }
              },
              "Condition": {
                "id": "Condition",
                "path": "SecurityFindingGeneratorStack/CDKMetadata/Condition",
                "constructInfo": {
                  "fqn": "aws-cdk-lib.CfnCondition",
                  "version": "2.118.0"
                }
              }
            },
            "constructInfo": {
              "fqn": "constructs.Construct",
              "version": "10.3.0"
            }
          },
          "BootstrapVersion": {
            "id": "BootstrapVersion",
            "path": "SecurityFindingGeneratorStack/BootstrapVersion",
            "constructInfo": {
              "fqn": "aws-cdk-lib.CfnParameter",
              "version": "2.118.0"
            }
          },
          "CheckBootstrapVersion": {
            "id": "CheckBootstrapVersion",
            "path": "SecurityFindingGeneratorStack/CheckBootstrapVersion",
            "constructInfo": {
              "fqn": "aws-cdk-lib.CfnRule",
              "version": "2.118.0"
            }
          }
        },
        "constructInfo": {
          "fqn": "aws-cdk-lib.Stack",
          "version": "2.118.0"
        }
      },
      "Tree": {
        "id": "Tree",
        "path": "Tree",
        "constructInfo": {
          "fqn": "constructs.Construct",
          "version": "10.3.0"
        }
      }
    },
    "constructInfo": {
      "fqn": "aws-cdk-lib.App",
      "version": "2.118.0"
    }
  }
}